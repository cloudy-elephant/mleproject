[2025-11-05T09:45:38.892+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-11-05T09:45:38.923+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: e2e_pipeline.catboost_gold_train manual__2025-11-05T09:45:06.762932+00:00 [queued]>
[2025-11-05T09:45:38.943+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: e2e_pipeline.catboost_gold_train manual__2025-11-05T09:45:06.762932+00:00 [queued]>
[2025-11-05T09:45:38.945+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 1
[2025-11-05T09:45:38.994+0000] {taskinstance.py:2888} INFO - Executing <Task(BashOperator): catboost_gold_train> on 2025-11-05 09:45:06.762932+00:00
[2025-11-05T09:45:39.001+0000] {standard_task_runner.py:72} INFO - Started process 206 to run task
[2025-11-05T09:45:39.008+0000] {standard_task_runner.py:104} INFO - Running: ['airflow', 'tasks', 'run', 'e2e_pipeline', 'catboost_gold_train', 'manual__2025-11-05T09:45:06.762932+00:00', '--job-id', '35', '--raw', '--subdir', 'DAGS_FOLDER/e2e_pipeline_dag.py', '--cfg-path', '/tmp/tmpj6w4eg60']
[2025-11-05T09:45:39.012+0000] {standard_task_runner.py:105} INFO - Job 35: Subtask catboost_gold_train
[2025-11-05T09:45:39.110+0000] {task_command.py:467} INFO - Running <TaskInstance: e2e_pipeline.catboost_gold_train manual__2025-11-05T09:45:06.762932+00:00 [running]> on host 733ebcbf0503
[2025-11-05T09:45:39.219+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='e2e_pipeline' AIRFLOW_CTX_TASK_ID='catboost_gold_train' AIRFLOW_CTX_EXECUTION_DATE='2025-11-05T09:45:06.762932+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-11-05T09:45:06.762932+00:00'
[2025-11-05T09:45:39.220+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-11-05T09:45:39.234+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-11-05T09:45:39.236+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'python /opt/airflow/scripts/catboost_gold_train.py']
[2025-11-05T09:45:39.244+0000] {subprocess.py:86} INFO - Output:
[2025-11-05T09:45:42.318+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,318 [INFO] ============================================================
[2025-11-05T09:45:42.320+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,318 [INFO] CatBoost Gold Price Prediction - 开始训练
[2025-11-05T09:45:42.320+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,318 [INFO] ============================================================
[2025-11-05T09:45:42.321+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,319 [INFO]
[2025-11-05T09:45:42.322+0000] {subprocess.py:93} INFO - 配置信息:
[2025-11-05T09:45:42.323+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,319 [INFO]   数据路径: /opt/airflow/datamart/gold
[2025-11-05T09:45:42.324+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,319 [INFO]   输出路径: /opt/airflow/model_bank/catboost
[2025-11-05T09:45:42.325+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,320 [INFO]   训练范围: (2023, 2) - (2024, 4)
[2025-11-05T09:45:42.326+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,320 [INFO]   OOT范围:  (2024, 5) - (2024, 9)
[2025-11-05T09:45:42.327+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,320 [INFO] ============================================================
[2025-11-05T09:45:42.328+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,320 [INFO] 开始读取黄金价格数据...
[2025-11-05T09:45:42.329+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,320 [INFO] ============================================================
[2025-11-05T09:45:42.330+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,321 [INFO]
[2025-11-05T09:45:42.330+0000] {subprocess.py:93} INFO - 训练集: 2023-02 至 2024-04 (共15个月)
[2025-11-05T09:45:42.331+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,321 [INFO] OOT集: 2024-05 至 2024-09 (共5个月)
[2025-11-05T09:45:42.332+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,321 [INFO]
[2025-11-05T09:45:42.332+0000] {subprocess.py:93} INFO - 读取训练集数据...
[2025-11-05T09:45:42.333+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,321 [INFO] ------------------------------------------------------------
[2025-11-05T09:45:42.334+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,333 [INFO]   ✓ gold_2023_02_01.csv: 233 条记录
[2025-11-05T09:45:42.342+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,342 [INFO]   ✓ gold_2023_03_01.csv: 224 条记录
[2025-11-05T09:45:42.351+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,351 [INFO]   ✓ gold_2023_04_01.csv: 228 条记录
[2025-11-05T09:45:42.359+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,358 [INFO]   ✓ gold_2023_05_01.csv: 216 条记录
[2025-11-05T09:45:42.367+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,366 [INFO]   ✓ gold_2023_06_01.csv: 214 条记录
[2025-11-05T09:45:42.375+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,375 [INFO]   ✓ gold_2023_07_01.csv: 219 条记录
[2025-11-05T09:45:42.385+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,385 [INFO]   ✓ gold_2023_08_01.csv: 239 条记录
[2025-11-05T09:45:42.393+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,393 [INFO]   ✓ gold_2023_09_01.csv: 225 条记录
[2025-11-05T09:45:42.402+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,402 [INFO]   ✓ gold_2023_10_01.csv: 215 条记录
[2025-11-05T09:45:42.409+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,409 [INFO]   ✓ gold_2023_11_01.csv: 213 条记录
[2025-11-05T09:45:42.419+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,418 [INFO]   ✓ gold_2023_12_01.csv: 219 条记录
[2025-11-05T09:45:42.427+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,426 [INFO]   ✓ gold_2024_01_01.csv: 232 条记录
[2025-11-05T09:45:42.435+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,435 [INFO]   ✓ gold_2024_02_01.csv: 217 条记录
[2025-11-05T09:45:42.443+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,443 [INFO]   ✓ gold_2024_03_01.csv: 240 条记录
[2025-11-05T09:45:42.452+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,451 [INFO]   ✓ gold_2024_04_01.csv: 230 条记录
[2025-11-05T09:45:42.454+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,454 [INFO]
[2025-11-05T09:45:42.455+0000] {subprocess.py:93} INFO - 训练集合并完成: 3,364 条记录
[2025-11-05T09:45:42.456+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,454 [INFO]
[2025-11-05T09:45:42.457+0000] {subprocess.py:93} INFO - 读取OOT集数据...
[2025-11-05T09:45:42.458+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,455 [INFO] ------------------------------------------------------------
[2025-11-05T09:45:42.464+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,464 [INFO]   ✓ gold_2024_05_01.csv: 210 条记录
[2025-11-05T09:45:42.474+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,473 [INFO]   ✓ gold_2024_06_01.csv: 221 条记录
[2025-11-05T09:45:42.482+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,482 [INFO]   ✓ gold_2024_07_01.csv: 231 条记录
[2025-11-05T09:45:42.491+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,491 [INFO]   ✓ gold_2024_08_01.csv: 221 条记录
[2025-11-05T09:45:42.499+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,499 [INFO]   ✓ gold_2024_09_01.csv: 216 条记录
[2025-11-05T09:45:42.500+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,500 [INFO]
[2025-11-05T09:45:42.501+0000] {subprocess.py:93} INFO - OOT集合并完成: 1,099 条记录
[2025-11-05T09:45:42.502+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,500 [INFO]
[2025-11-05T09:45:42.503+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:45:42.504+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,500 [INFO] 数据加载完成!
[2025-11-05T09:45:42.505+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,500 [INFO] ============================================================
[2025-11-05T09:45:42.506+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,501 [INFO]
[2025-11-05T09:45:42.507+0000] {subprocess.py:93} INFO - 训练集: 3,364 条 × 38 列
[2025-11-05T09:45:42.508+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,501 [INFO] OOT集:  1,099 条 × 38 列
[2025-11-05T09:45:42.509+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,502 [INFO]
[2025-11-05T09:45:42.510+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:45:42.511+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,502 [INFO] 开始数据预处理...
[2025-11-05T09:45:42.512+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,503 [INFO] ============================================================
[2025-11-05T09:45:42.513+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,507 [INFO] ✓ 找到目标变量: Churn
[2025-11-05T09:45:42.513+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,509 [INFO] ✓ 目标变量转换完成 (Yes/No -> 1/0)
[2025-11-05T09:45:42.514+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,509 [INFO]
[2025-11-05T09:45:42.515+0000] {subprocess.py:93} INFO - 目标变量分布:
[2025-11-05T09:45:42.516+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,510 [INFO] Churn
[2025-11-05T09:45:42.517+0000] {subprocess.py:93} INFO - 0    3262
[2025-11-05T09:45:42.518+0000] {subprocess.py:93} INFO - 1    1201
[2025-11-05T09:45:42.519+0000] {subprocess.py:93} INFO - Name: count, dtype: int64
[2025-11-05T09:45:42.520+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,511 [INFO] 正样本比例: 26.91%
[2025-11-05T09:45:42.521+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,512 [INFO] ✓ 已移除ID列: customerID
[2025-11-05T09:45:42.521+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,517 [INFO] ✓ 日期特征提取完成: snapdate
[2025-11-05T09:45:42.523+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,519 [INFO] ✓ 数值型缺失值填充完成
[2025-11-05T09:45:42.524+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,524 [INFO] ✓ 类别型缺失值填充完成
[2025-11-05T09:45:42.527+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,524 [INFO]
[2025-11-05T09:45:42.528+0000] {subprocess.py:93} INFO - ------------------------------------------------------------
[2025-11-05T09:45:42.529+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,525 [INFO] 识别和处理类别特征...
[2025-11-05T09:45:42.530+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,525 [INFO] ------------------------------------------------------------
[2025-11-05T09:45:42.531+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,530 [INFO] ✓ 识别到 27 个类别特征
[2025-11-05T09:45:42.532+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,531 [INFO] 类别特征: ['Contract', 'PaperlessBilling', 'PaymentMethod', 'AutoRenewal', 'BillingCycle', 'DiscountApplied', 'LoyaltyProgramMember', 'PhoneService', 'MultipleLines', 'InternetService']...
[2025-11-05T09:45:42.533+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,531 [INFO]
[2025-11-05T09:45:42.534+0000] {subprocess.py:93} INFO - ✓ 数据预处理完成，当前数据维度: (4463, 39)
[2025-11-05T09:45:42.535+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,532 [INFO]
[2025-11-05T09:45:42.535+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:45:42.536+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,532 [INFO] 准备训练数据...
[2025-11-05T09:45:42.537+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,532 [INFO] ============================================================
[2025-11-05T09:45:42.538+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,538 [INFO]
[2025-11-05T09:45:42.539+0000] {subprocess.py:93} INFO - 时间范围分布:
[2025-11-05T09:45:42.540+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,538 [INFO]   训练+验证集: 3364 条
[2025-11-05T09:45:42.541+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,539 [INFO]   OOT集: 2018 条
[2025-11-05T09:45:42.544+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,543 [INFO]
[2025-11-05T09:45:42.545+0000] {subprocess.py:93} INFO - 最终划分:
[2025-11-05T09:45:42.546+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,544 [INFO]   训练集: (2691, 35)
[2025-11-05T09:45:42.547+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,544 [INFO]   验证集: (673, 35)
[2025-11-05T09:45:42.548+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,545 [INFO]   OOT集: (2018, 35)
[2025-11-05T09:45:42.549+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,545 [INFO]
[2025-11-05T09:45:42.550+0000] {subprocess.py:93} INFO - 类别特征索引: 27 个
[2025-11-05T09:45:42.550+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,546 [INFO]
[2025-11-05T09:45:42.551+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:45:42.552+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,546 [INFO] 训练CatBoost模型...
[2025-11-05T09:45:42.553+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,546 [INFO] ============================================================
[2025-11-05T09:45:42.554+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,547 [INFO] 模型配置:
[2025-11-05T09:45:42.555+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,547 [INFO]   - iterations: 1000
[2025-11-05T09:45:42.556+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,547 [INFO]   - learning_rate: 0.03
[2025-11-05T09:45:42.557+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,548 [INFO]   - depth: 6
[2025-11-05T09:45:42.558+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,548 [INFO]   - cat_features: 27 个
[2025-11-05T09:45:42.559+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,549 [INFO]
[2025-11-05T09:45:42.559+0000] {subprocess.py:93} INFO - 开始训练...
[2025-11-05T09:45:42.561+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:42,549 [INFO] ------------------------------------------------------------
[2025-11-05T09:45:44.875+0000] {subprocess.py:93} INFO - 0:	test: 0.7885158	best: 0.7885158 (0)	total: 65.3ms	remaining: 1m 5s
[2025-11-05T09:45:44.876+0000] {subprocess.py:93} INFO - 100:	test: 0.8228750	best: 0.8232306 (96)	total: 695ms	remaining: 6.18s
[2025-11-05T09:45:44.876+0000] {subprocess.py:93} INFO - 200:	test: 0.8284876	best: 0.8288099 (197)	total: 1.4s	remaining: 5.55s
[2025-11-05T09:45:44.877+0000] {subprocess.py:93} INFO - 300:	test: 0.8301214	best: 0.8305215 (286)	total: 2.01s	remaining: 4.67s
[2025-11-05T09:45:44.877+0000] {subprocess.py:93} INFO - Stopped by overfitting detector  (50 iterations wait)
[2025-11-05T09:45:44.878+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:45:44.880+0000] {subprocess.py:93} INFO - bestTest = 0.8305214724
[2025-11-05T09:45:44.881+0000] {subprocess.py:93} INFO - bestIteration = 286
[2025-11-05T09:45:44.882+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:45:44.883+0000] {subprocess.py:93} INFO - Shrink model to first 287 iterations.
[2025-11-05T09:45:44.884+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,874 [INFO]
[2025-11-05T09:45:44.884+0000] {subprocess.py:93} INFO - ✓ 模型训练完成！
[2025-11-05T09:45:44.885+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,875 [INFO] ✓ 最佳迭代次数: 286
[2025-11-05T09:45:44.886+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,875 [INFO] ✓ 最佳验证AUC: 0.8305
[2025-11-05T09:45:44.887+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,875 [INFO]
[2025-11-05T09:45:44.887+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:45:44.888+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,875 [INFO] 模型评估...
[2025-11-05T09:45:44.888+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,875 [INFO] ============================================================
[2025-11-05T09:45:44.889+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,885 [INFO]
[2025-11-05T09:45:44.889+0000] {subprocess.py:93} INFO - 验证集评估:
[2025-11-05T09:45:44.890+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,886 [INFO] ============================================================
[2025-11-05T09:45:44.892+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,891 [INFO]
[2025-11-05T09:45:44.892+0000] {subprocess.py:93} INFO -               precision    recall  f1-score   support
[2025-11-05T09:45:44.893+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:45:44.893+0000] {subprocess.py:93} INFO -            0       0.91      0.70      0.79       489
[2025-11-05T09:45:44.893+0000] {subprocess.py:93} INFO -            1       0.50      0.81      0.62       184
[2025-11-05T09:45:44.894+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:45:44.894+0000] {subprocess.py:93} INFO -     accuracy                           0.73       673
[2025-11-05T09:45:44.895+0000] {subprocess.py:93} INFO -    macro avg       0.71      0.75      0.71       673
[2025-11-05T09:45:44.896+0000] {subprocess.py:93} INFO - weighted avg       0.80      0.73      0.74       673
[2025-11-05T09:45:44.897+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:45:44.898+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,894 [INFO]
[2025-11-05T09:45:44.898+0000] {subprocess.py:93} INFO - 核心指标:
[2025-11-05T09:45:44.899+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,894 [INFO]   Accuracy: 0.7296
[2025-11-05T09:45:44.899+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,894 [INFO]   AUC-ROC:  0.8305
[2025-11-05T09:45:44.900+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,895 [INFO]
[2025-11-05T09:45:44.901+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:45:44.901+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,895 [INFO] OOT集评估:
[2025-11-05T09:45:44.902+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,895 [INFO] ============================================================
[2025-11-05T09:45:44.922+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,922 [INFO]
[2025-11-05T09:45:44.923+0000] {subprocess.py:93} INFO -               precision    recall  f1-score   support
[2025-11-05T09:45:44.924+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:45:44.925+0000] {subprocess.py:93} INFO -            0       0.92      0.73      0.81      1488
[2025-11-05T09:45:44.926+0000] {subprocess.py:93} INFO -            1       0.51      0.82      0.63       530
[2025-11-05T09:45:44.927+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:45:44.927+0000] {subprocess.py:93} INFO -     accuracy                           0.75      2018
[2025-11-05T09:45:44.928+0000] {subprocess.py:93} INFO -    macro avg       0.72      0.77      0.72      2018
[2025-11-05T09:45:44.929+0000] {subprocess.py:93} INFO - weighted avg       0.81      0.75      0.76      2018
[2025-11-05T09:45:44.930+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:45:44.931+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,925 [INFO]
[2025-11-05T09:45:44.932+0000] {subprocess.py:93} INFO - 核心指标:
[2025-11-05T09:45:44.933+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,925 [INFO]   Accuracy: 0.7498
[2025-11-05T09:45:44.934+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,925 [INFO]   AUC-ROC:  0.8569
[2025-11-05T09:45:44.935+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,925 [INFO]
[2025-11-05T09:45:44.936+0000] {subprocess.py:93} INFO - 模型稳定性 (PSI): 0.0146
[2025-11-05T09:45:44.937+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,926 [INFO]   ✓ PSI < 0.1: 模型稳定性良好
[2025-11-05T09:45:44.938+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,926 [INFO]
[2025-11-05T09:45:44.939+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:45:44.940+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,926 [INFO] 保存模型和结果...
[2025-11-05T09:45:44.941+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,926 [INFO] ============================================================
[2025-11-05T09:45:44.946+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,946 [INFO] ✓ 模型已保存: /opt/airflow/model_bank/catboost/catboost_gold_model.cbm
[2025-11-05T09:45:44.955+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,955 [INFO] ✓ 特征重要性已保存: /opt/airflow/model_bank/catboost/feature_importance.csv
[2025-11-05T09:45:44.960+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,960 [INFO] ✓ 预测结果已保存: /opt/airflow/model_bank/catboost/predictions.csv
[2025-11-05T09:45:44.964+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,964 [INFO] ✓ 评估指标已保存: /opt/airflow/model_bank/catboost/model_metrics.csv
[2025-11-05T09:45:44.965+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,964 [INFO]
[2025-11-05T09:45:44.966+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:45:44.967+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,964 [INFO] ✅ 所有结果已保存!
[2025-11-05T09:45:44.968+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,965 [INFO] ============================================================
[2025-11-05T09:45:44.968+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,965 [INFO]
[2025-11-05T09:45:44.969+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:45:44.970+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,965 [INFO] ✅ 训练流程全部完成！
[2025-11-05T09:45:44.970+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,965 [INFO] ============================================================
[2025-11-05T09:45:44.971+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,965 [INFO]
[2025-11-05T09:45:44.973+0000] {subprocess.py:93} INFO - 生成的文件位于: /opt/airflow/model_bank/catboost
[2025-11-05T09:45:44.973+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,966 [INFO]
[2025-11-05T09:45:44.974+0000] {subprocess.py:93} INFO - 模型加载示例:
[2025-11-05T09:45:44.975+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,966 [INFO]   from catboost import CatBoostClassifier
[2025-11-05T09:45:44.975+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,966 [INFO]   model = CatBoostClassifier()
[2025-11-05T09:45:44.976+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:44,966 [INFO]   model.load_model('/opt/airflow/model_bank/catboost/catboost_gold_model.cbm')
[2025-11-05T09:45:45.100+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-11-05T09:45:45.145+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-11-05T09:45:45.146+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=e2e_pipeline, task_id=catboost_gold_train, run_id=manual__2025-11-05T09:45:06.762932+00:00, execution_date=20251105T094506, start_date=20251105T094538, end_date=20251105T094545
[2025-11-05T09:45:45.203+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-11-05T09:45:45.241+0000] {taskinstance.py:3900} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-11-05T09:45:45.255+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
