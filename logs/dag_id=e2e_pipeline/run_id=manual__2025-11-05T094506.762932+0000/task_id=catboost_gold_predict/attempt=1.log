[2025-11-05T09:45:47.855+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-11-05T09:45:47.869+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: e2e_pipeline.catboost_gold_predict manual__2025-11-05T09:45:06.762932+00:00 [queued]>
[2025-11-05T09:45:47.880+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: e2e_pipeline.catboost_gold_predict manual__2025-11-05T09:45:06.762932+00:00 [queued]>
[2025-11-05T09:45:47.881+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 1
[2025-11-05T09:45:47.915+0000] {taskinstance.py:2888} INFO - Executing <Task(BashOperator): catboost_gold_predict> on 2025-11-05 09:45:06.762932+00:00
[2025-11-05T09:45:47.920+0000] {standard_task_runner.py:72} INFO - Started process 326 to run task
[2025-11-05T09:45:47.923+0000] {standard_task_runner.py:104} INFO - Running: ['airflow', 'tasks', 'run', 'e2e_pipeline', 'catboost_gold_predict', 'manual__2025-11-05T09:45:06.762932+00:00', '--job-id', '36', '--raw', '--subdir', 'DAGS_FOLDER/e2e_pipeline_dag.py', '--cfg-path', '/tmp/tmp9q8hly76']
[2025-11-05T09:45:47.927+0000] {standard_task_runner.py:105} INFO - Job 36: Subtask catboost_gold_predict
[2025-11-05T09:45:48.007+0000] {task_command.py:467} INFO - Running <TaskInstance: e2e_pipeline.catboost_gold_predict manual__2025-11-05T09:45:06.762932+00:00 [running]> on host 733ebcbf0503
[2025-11-05T09:45:48.114+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='e2e_pipeline' AIRFLOW_CTX_TASK_ID='catboost_gold_predict' AIRFLOW_CTX_EXECUTION_DATE='2025-11-05T09:45:06.762932+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-11-05T09:45:06.762932+00:00'
[2025-11-05T09:45:48.116+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-11-05T09:45:48.128+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-11-05T09:45:48.131+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'python /opt/airflow/scripts/catboost_gold_predict.py']
[2025-11-05T09:45:48.141+0000] {subprocess.py:86} INFO - Output:
[2025-11-05T09:45:48.968+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:48,963 [INFO] ============================================================
[2025-11-05T09:45:48.972+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:48,963 [INFO] CatBoost Gold Price Prediction - 开始预测
[2025-11-05T09:45:48.973+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:48,963 [INFO] ============================================================
[2025-11-05T09:45:48.975+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:48,963 [INFO] [auto] ROOT         = /opt/airflow
[2025-11-05T09:45:48.976+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:48,963 [INFO] [auto] MODEL_PATH   = /opt/airflow/model_bank/catboost/catboost_gold_model.cbm
[2025-11-05T09:45:48.977+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:48,963 [INFO] [auto] DATA_PATH    = /opt/airflow/datamart/gold/gold_2024_09_01.csv
[2025-11-05T09:45:48.978+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:48,963 [INFO] [auto] OUTPUT_PATH  = /opt/airflow/model_bank/predictions/predictions_20251105_094548.csv
[2025-11-05T09:45:48.979+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:48,963 [INFO] 加载模型: /opt/airflow/model_bank/catboost/catboost_gold_model.cbm
[2025-11-05T09:45:48.983+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:48,982 [INFO] ✓ 模型加载成功
[2025-11-05T09:45:48.983+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:48,983 [INFO] 加载数据: /opt/airflow/datamart/gold/gold_2024_09_01.csv
[2025-11-05T09:45:48.990+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:48,990 [INFO] ✓ 数据加载成功: 216 条 × 35 列
[2025-11-05T09:45:48.990+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:48,990 [INFO] 预处理数据...
[2025-11-05T09:45:48.991+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:48,990 [INFO]   移除ID列: customerID
[2025-11-05T09:45:48.994+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:48,994 [INFO]   提取日期特征: snapdate
[2025-11-05T09:45:49.001+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,001 [INFO] ✓ 数据预处理完成
[2025-11-05T09:45:49.001+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,001 [INFO] 开始预测...
[2025-11-05T09:45:49.002+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,002 [INFO] 检测到类别列 28 个: ['Churn', 'Contract', 'PaperlessBilling', 'PaymentMethod', 'AutoRenewal', 'BillingCycle', 'DiscountApplied', 'LoyaltyProgramMember', 'PhoneService', 'MultipleLines', 'InternetService', 'OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies', 'SmartHomePackage', 'GamingBundle', 'InternationalCallingPlan', 'CloudStoragePlan', 'gender', 'Partner', 'Dependents', 'EducationLevel', 'EmploymentStatus', 'AnnualIncomeBracket', 'CustomerSatisfactionScore']
[2025-11-05T09:45:49.006+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,006 [INFO] ✓ 预测完成: 216 条记录
[2025-11-05T09:45:49.007+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,006 [INFO] 类别分布: 0=126, 1=90
[2025-11-05T09:45:49.008+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,006 [INFO] 平均预测概率: 0.4125
[2025-11-05T09:45:49.011+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,011 [INFO] ✓ 预测结果已保存: /opt/airflow/model_bank/predictions/predictions_20251105_094548.csv
[2025-11-05T09:45:49.012+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,011 [INFO]
[2025-11-05T09:45:49.013+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:45:49.014+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,011 [INFO] ✅ 预测流程完成！
[2025-11-05T09:45:49.015+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,011 [INFO] ============================================================
[2025-11-05T09:45:49.015+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,011 [INFO]
[2025-11-05T09:45:49.016+0000] {subprocess.py:93} INFO - 预测结果示例（前5行）:
[2025-11-05T09:45:49.017+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,015 [INFO]
[2025-11-05T09:45:49.017+0000] {subprocess.py:93} INFO -    prediction  probability
[2025-11-05T09:45:49.018+0000] {subprocess.py:93} INFO - 0           1     0.853207
[2025-11-05T09:45:49.018+0000] {subprocess.py:93} INFO - 1           1     0.680816
[2025-11-05T09:45:49.019+0000] {subprocess.py:93} INFO - 2           0     0.054123
[2025-11-05T09:45:49.020+0000] {subprocess.py:93} INFO - 3           0     0.414024
[2025-11-05T09:45:49.021+0000] {subprocess.py:93} INFO - 4           1     0.757927
[2025-11-05T09:45:49.049+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,049 [INFO] ============================================================
[2025-11-05T09:45:49.050+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,049 [INFO] CatBoost Gold Price Prediction - 开始预测
[2025-11-05T09:45:49.051+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,049 [INFO] ============================================================
[2025-11-05T09:45:49.052+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,049 [INFO] [auto] ROOT         = /opt/airflow
[2025-11-05T09:45:49.052+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,049 [INFO] [auto] MODEL_PATH   = /opt/airflow/model_bank/catboost/catboost_gold_model.cbm
[2025-11-05T09:45:49.053+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,049 [INFO] [auto] DATA_PATH    = /opt/airflow/datamart/gold/gold_2024_09_01.csv
[2025-11-05T09:45:49.054+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,049 [INFO] [auto] OUTPUT_PATH  = /opt/airflow/model_bank/predictions/predictions_20251105_094549.csv
[2025-11-05T09:45:49.055+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,049 [INFO] 加载模型: /opt/airflow/model_bank/catboost/catboost_gold_model.cbm
[2025-11-05T09:45:49.059+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,059 [INFO] ✓ 模型加载成功
[2025-11-05T09:45:49.061+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,059 [INFO] 加载数据: /opt/airflow/datamart/gold/gold_2024_09_01.csv
[2025-11-05T09:45:49.066+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,066 [INFO] ✓ 数据加载成功: 216 条 × 35 列
[2025-11-05T09:45:49.067+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,066 [INFO] 预处理数据...
[2025-11-05T09:45:49.072+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,067 [INFO]   移除ID列: customerID
[2025-11-05T09:45:49.072+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,069 [INFO]   提取日期特征: snapdate
[2025-11-05T09:45:49.074+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,074 [INFO] ✓ 数据预处理完成
[2025-11-05T09:45:49.076+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,074 [INFO] 开始预测...
[2025-11-05T09:45:49.077+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,076 [INFO] 检测到类别列 28 个: ['Churn', 'Contract', 'PaperlessBilling', 'PaymentMethod', 'AutoRenewal', 'BillingCycle', 'DiscountApplied', 'LoyaltyProgramMember', 'PhoneService', 'MultipleLines', 'InternetService', 'OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies', 'SmartHomePackage', 'GamingBundle', 'InternationalCallingPlan', 'CloudStoragePlan', 'gender', 'Partner', 'Dependents', 'EducationLevel', 'EmploymentStatus', 'AnnualIncomeBracket', 'CustomerSatisfactionScore']
[2025-11-05T09:45:49.080+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,080 [INFO] ✓ 预测完成: 216 条记录
[2025-11-05T09:45:49.081+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,080 [INFO] 类别分布: 0=126, 1=90
[2025-11-05T09:45:49.082+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,080 [INFO] 平均预测概率: 0.4125
[2025-11-05T09:45:49.084+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,084 [INFO] ✓ 预测结果已保存: /opt/airflow/model_bank/predictions/predictions_20251105_094549.csv
[2025-11-05T09:45:49.085+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,084 [INFO]
[2025-11-05T09:45:49.087+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:45:49.088+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,084 [INFO] ✅ 预测流程完成！
[2025-11-05T09:45:49.088+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,084 [INFO] ============================================================
[2025-11-05T09:45:49.089+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,084 [INFO]
[2025-11-05T09:45:49.089+0000] {subprocess.py:93} INFO - 预测结果示例（前5行）:
[2025-11-05T09:45:49.090+0000] {subprocess.py:93} INFO - 2025-11-05 09:45:49,087 [INFO]
[2025-11-05T09:45:49.091+0000] {subprocess.py:93} INFO -    prediction  probability
[2025-11-05T09:45:49.092+0000] {subprocess.py:93} INFO - 0           1     0.853207
[2025-11-05T09:45:49.093+0000] {subprocess.py:93} INFO - 1           1     0.680816
[2025-11-05T09:45:49.093+0000] {subprocess.py:93} INFO - 2           0     0.054123
[2025-11-05T09:45:49.094+0000] {subprocess.py:93} INFO - 3           0     0.414024
[2025-11-05T09:45:49.094+0000] {subprocess.py:93} INFO - 4           1     0.757927
[2025-11-05T09:45:49.134+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-11-05T09:45:49.176+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-11-05T09:45:49.177+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=e2e_pipeline, task_id=catboost_gold_predict, run_id=manual__2025-11-05T09:45:06.762932+00:00, execution_date=20251105T094506, start_date=20251105T094547, end_date=20251105T094549
[2025-11-05T09:45:49.225+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-11-05T09:45:49.254+0000] {taskinstance.py:3900} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-11-05T09:45:49.266+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
