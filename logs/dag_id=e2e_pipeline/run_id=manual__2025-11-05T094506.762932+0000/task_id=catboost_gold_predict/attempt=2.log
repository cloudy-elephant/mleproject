[2025-11-05T09:52:12.201+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-11-05T09:52:12.219+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: e2e_pipeline.catboost_gold_predict manual__2025-11-05T09:45:06.762932+00:00 [queued]>
[2025-11-05T09:52:12.228+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: e2e_pipeline.catboost_gold_predict manual__2025-11-05T09:45:06.762932+00:00 [queued]>
[2025-11-05T09:52:12.229+0000] {taskinstance.py:2865} INFO - Starting attempt 2 of 2
[2025-11-05T09:52:12.256+0000] {taskinstance.py:2888} INFO - Executing <Task(BashOperator): catboost_gold_predict> on 2025-11-05 09:45:06.762932+00:00
[2025-11-05T09:52:12.261+0000] {standard_task_runner.py:72} INFO - Started process 504 to run task
[2025-11-05T09:52:12.264+0000] {standard_task_runner.py:104} INFO - Running: ['airflow', 'tasks', 'run', 'e2e_pipeline', 'catboost_gold_predict', 'manual__2025-11-05T09:45:06.762932+00:00', '--job-id', '39', '--raw', '--subdir', 'DAGS_FOLDER/e2e_pipeline_dag.py', '--cfg-path', '/tmp/tmpi5fon3ov']
[2025-11-05T09:52:12.267+0000] {standard_task_runner.py:105} INFO - Job 39: Subtask catboost_gold_predict
[2025-11-05T09:52:12.344+0000] {task_command.py:467} INFO - Running <TaskInstance: e2e_pipeline.catboost_gold_predict manual__2025-11-05T09:45:06.762932+00:00 [running]> on host 733ebcbf0503
[2025-11-05T09:52:12.443+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='e2e_pipeline' AIRFLOW_CTX_TASK_ID='catboost_gold_predict' AIRFLOW_CTX_EXECUTION_DATE='2025-11-05T09:45:06.762932+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-11-05T09:45:06.762932+00:00'
[2025-11-05T09:52:12.444+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-11-05T09:52:12.454+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-11-05T09:52:12.456+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'python /opt/airflow/scripts/catboost_gold_predict.py']
[2025-11-05T09:52:12.463+0000] {subprocess.py:86} INFO - Output:
[2025-11-05T09:52:13.286+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,286 [INFO] ============================================================
[2025-11-05T09:52:13.287+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,286 [INFO] CatBoost Gold Price Prediction - 开始预测
[2025-11-05T09:52:13.289+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,286 [INFO] ============================================================
[2025-11-05T09:52:13.289+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,286 [INFO] [auto] ROOT         = /opt/airflow
[2025-11-05T09:52:13.290+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,286 [INFO] [auto] MODEL_PATH   = /opt/airflow/model_bank/catboost/catboost_gold_model.cbm
[2025-11-05T09:52:13.291+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,286 [INFO] [auto] DATA_PATH    = /opt/airflow/datamart/gold/gold_2024_09_01.csv
[2025-11-05T09:52:13.292+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,286 [INFO] [auto] OUTPUT_PATH  = /opt/airflow/model_bank/predictions/predictions_20251105_095213.csv
[2025-11-05T09:52:13.293+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,286 [INFO] 加载模型: /opt/airflow/model_bank/catboost/catboost_gold_model.cbm
[2025-11-05T09:52:13.302+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,302 [INFO] ✓ 模型加载成功
[2025-11-05T09:52:13.303+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,302 [INFO] 加载数据: /opt/airflow/datamart/gold/gold_2024_09_01.csv
[2025-11-05T09:52:13.316+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,314 [INFO] ✓ 数据加载成功: 216 条 × 35 列
[2025-11-05T09:52:13.317+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,314 [INFO] 预处理数据...
[2025-11-05T09:52:13.317+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,314 [INFO]   移除ID列: customerID
[2025-11-05T09:52:13.318+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,318 [INFO]   提取日期特征: snapdate
[2025-11-05T09:52:13.323+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,323 [INFO] ✓ 数据预处理完成
[2025-11-05T09:52:13.324+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,323 [INFO] 开始预测...
[2025-11-05T09:52:13.324+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,324 [INFO] 检测到类别列 28 个: ['Churn', 'Contract', 'PaperlessBilling', 'PaymentMethod', 'AutoRenewal', 'BillingCycle', 'DiscountApplied', 'LoyaltyProgramMember', 'PhoneService', 'MultipleLines', 'InternetService', 'OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies', 'SmartHomePackage', 'GamingBundle', 'InternationalCallingPlan', 'CloudStoragePlan', 'gender', 'Partner', 'Dependents', 'EducationLevel', 'EmploymentStatus', 'AnnualIncomeBracket', 'CustomerSatisfactionScore']
[2025-11-05T09:52:13.329+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,329 [INFO] ✓ 预测完成: 216 条记录
[2025-11-05T09:52:13.329+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,329 [INFO] 类别分布: 0=126, 1=90
[2025-11-05T09:52:13.330+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,329 [INFO] 平均预测概率: 0.4125
[2025-11-05T09:52:13.334+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,334 [INFO] ✓ 预测结果已保存: /opt/airflow/model_bank/predictions/predictions_20251105_095213.csv
[2025-11-05T09:52:13.335+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,334 [INFO]
[2025-11-05T09:52:13.336+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:52:13.337+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,334 [INFO] ✅ 预测流程完成！
[2025-11-05T09:52:13.337+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,334 [INFO] ============================================================
[2025-11-05T09:52:13.338+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,334 [INFO]
[2025-11-05T09:52:13.339+0000] {subprocess.py:93} INFO - 预测结果示例（前5行）:
[2025-11-05T09:52:13.339+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,337 [INFO]
[2025-11-05T09:52:13.340+0000] {subprocess.py:93} INFO -    prediction  probability
[2025-11-05T09:52:13.340+0000] {subprocess.py:93} INFO - 0           1     0.853207
[2025-11-05T09:52:13.341+0000] {subprocess.py:93} INFO - 1           1     0.680816
[2025-11-05T09:52:13.342+0000] {subprocess.py:93} INFO - 2           0     0.054123
[2025-11-05T09:52:13.343+0000] {subprocess.py:93} INFO - 3           0     0.414024
[2025-11-05T09:52:13.343+0000] {subprocess.py:93} INFO - 4           1     0.757927
[2025-11-05T09:52:13.374+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,373 [INFO] ============================================================
[2025-11-05T09:52:13.374+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,373 [INFO] CatBoost Gold Price Prediction - 开始预测
[2025-11-05T09:52:13.375+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,373 [INFO] ============================================================
[2025-11-05T09:52:13.376+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,373 [INFO] [auto] ROOT         = /opt/airflow
[2025-11-05T09:52:13.377+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,374 [INFO] [auto] MODEL_PATH   = /opt/airflow/model_bank/catboost/catboost_gold_model.cbm
[2025-11-05T09:52:13.378+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,374 [INFO] [auto] DATA_PATH    = /opt/airflow/datamart/gold/gold_2024_09_01.csv
[2025-11-05T09:52:13.378+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,374 [INFO] [auto] OUTPUT_PATH  = /opt/airflow/model_bank/predictions/predictions_20251105_095213.csv
[2025-11-05T09:52:13.379+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,374 [INFO] 加载模型: /opt/airflow/model_bank/catboost/catboost_gold_model.cbm
[2025-11-05T09:52:13.386+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,386 [INFO] ✓ 模型加载成功
[2025-11-05T09:52:13.387+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,386 [INFO] 加载数据: /opt/airflow/datamart/gold/gold_2024_09_01.csv
[2025-11-05T09:52:13.392+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,392 [INFO] ✓ 数据加载成功: 216 条 × 35 列
[2025-11-05T09:52:13.393+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,392 [INFO] 预处理数据...
[2025-11-05T09:52:13.394+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,392 [INFO]   移除ID列: customerID
[2025-11-05T09:52:13.395+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,395 [INFO]   提取日期特征: snapdate
[2025-11-05T09:52:13.400+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,400 [INFO] ✓ 数据预处理完成
[2025-11-05T09:52:13.402+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,400 [INFO] 开始预测...
[2025-11-05T09:52:13.402+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,402 [INFO] 检测到类别列 28 个: ['Churn', 'Contract', 'PaperlessBilling', 'PaymentMethod', 'AutoRenewal', 'BillingCycle', 'DiscountApplied', 'LoyaltyProgramMember', 'PhoneService', 'MultipleLines', 'InternetService', 'OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies', 'SmartHomePackage', 'GamingBundle', 'InternationalCallingPlan', 'CloudStoragePlan', 'gender', 'Partner', 'Dependents', 'EducationLevel', 'EmploymentStatus', 'AnnualIncomeBracket', 'CustomerSatisfactionScore']
[2025-11-05T09:52:13.405+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,405 [INFO] ✓ 预测完成: 216 条记录
[2025-11-05T09:52:13.406+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,405 [INFO] 类别分布: 0=126, 1=90
[2025-11-05T09:52:13.407+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,405 [INFO] 平均预测概率: 0.4125
[2025-11-05T09:52:13.411+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,411 [INFO] ✓ 预测结果已保存: /opt/airflow/model_bank/predictions/predictions_20251105_095213.csv
[2025-11-05T09:52:13.412+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,411 [INFO]
[2025-11-05T09:52:13.413+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:52:13.414+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,411 [INFO] ✅ 预测流程完成！
[2025-11-05T09:52:13.414+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,411 [INFO] ============================================================
[2025-11-05T09:52:13.415+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,411 [INFO]
[2025-11-05T09:52:13.415+0000] {subprocess.py:93} INFO - 预测结果示例（前5行）:
[2025-11-05T09:52:13.416+0000] {subprocess.py:93} INFO - 2025-11-05 09:52:13,413 [INFO]
[2025-11-05T09:52:13.417+0000] {subprocess.py:93} INFO -    prediction  probability
[2025-11-05T09:52:13.418+0000] {subprocess.py:93} INFO - 0           1     0.853207
[2025-11-05T09:52:13.418+0000] {subprocess.py:93} INFO - 1           1     0.680816
[2025-11-05T09:52:13.419+0000] {subprocess.py:93} INFO - 2           0     0.054123
[2025-11-05T09:52:13.419+0000] {subprocess.py:93} INFO - 3           0     0.414024
[2025-11-05T09:52:13.420+0000] {subprocess.py:93} INFO - 4           1     0.757927
[2025-11-05T09:52:13.458+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-11-05T09:52:13.501+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-11-05T09:52:13.502+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=e2e_pipeline, task_id=catboost_gold_predict, run_id=manual__2025-11-05T09:45:06.762932+00:00, execution_date=20251105T094506, start_date=20251105T095212, end_date=20251105T095213
[2025-11-05T09:52:13.565+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-11-05T09:52:13.601+0000] {taskinstance.py:3900} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-11-05T09:52:13.613+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
