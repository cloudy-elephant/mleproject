[2025-11-05T09:56:12.260+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-11-05T09:56:12.283+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: e2e_pipeline.catboost_gold_predict manual__2025-11-05T09:55:30.974057+00:00 [queued]>
[2025-11-05T09:56:12.296+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: e2e_pipeline.catboost_gold_predict manual__2025-11-05T09:55:30.974057+00:00 [queued]>
[2025-11-05T09:56:12.298+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 1
[2025-11-05T09:56:12.331+0000] {taskinstance.py:2888} INFO - Executing <Task(BashOperator): catboost_gold_predict> on 2025-11-05 09:55:30.974057+00:00
[2025-11-05T09:56:12.335+0000] {standard_task_runner.py:72} INFO - Started process 327 to run task
[2025-11-05T09:56:12.342+0000] {standard_task_runner.py:104} INFO - Running: ['airflow', 'tasks', 'run', 'e2e_pipeline', 'catboost_gold_predict', 'manual__2025-11-05T09:55:30.974057+00:00', '--job-id', '52', '--raw', '--subdir', 'DAGS_FOLDER/e2e_pipeline_dag.py', '--cfg-path', '/tmp/tmpkyjryjze']
[2025-11-05T09:56:12.345+0000] {standard_task_runner.py:105} INFO - Job 52: Subtask catboost_gold_predict
[2025-11-05T09:56:12.436+0000] {task_command.py:467} INFO - Running <TaskInstance: e2e_pipeline.catboost_gold_predict manual__2025-11-05T09:55:30.974057+00:00 [running]> on host 4fe7252a36f5
[2025-11-05T09:56:12.576+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='e2e_pipeline' AIRFLOW_CTX_TASK_ID='catboost_gold_predict' AIRFLOW_CTX_EXECUTION_DATE='2025-11-05T09:55:30.974057+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-11-05T09:55:30.974057+00:00'
[2025-11-05T09:56:12.578+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-11-05T09:56:12.591+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-11-05T09:56:12.593+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'python /opt/airflow/scripts/catboost_gold_predict.py']
[2025-11-05T09:56:12.602+0000] {subprocess.py:86} INFO - Output:
[2025-11-05T09:56:13.495+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,495 [INFO] ============================================================
[2025-11-05T09:56:13.497+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,495 [INFO] CatBoost Gold Price Prediction - 开始预测
[2025-11-05T09:56:13.498+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,495 [INFO] ============================================================
[2025-11-05T09:56:13.500+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,495 [INFO] [auto] ROOT         = /opt/airflow
[2025-11-05T09:56:13.501+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,495 [INFO] [auto] MODEL_PATH   = /opt/airflow/model_bank/catboost/catboost_gold_model.cbm
[2025-11-05T09:56:13.502+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,495 [INFO] [auto] DATA_PATH    = /opt/airflow/datamart/gold/gold_2024_09_01.csv
[2025-11-05T09:56:13.503+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,495 [INFO] [auto] OUTPUT_PATH  = /opt/airflow/model_bank/predictions/predictions_20251105_095613.csv
[2025-11-05T09:56:13.504+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,495 [INFO] 加载模型: /opt/airflow/model_bank/catboost/catboost_gold_model.cbm
[2025-11-05T09:56:13.512+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,512 [INFO] ✓ 模型加载成功
[2025-11-05T09:56:13.513+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,512 [INFO] 加载数据: /opt/airflow/datamart/gold/gold_2024_09_01.csv
[2025-11-05T09:56:13.520+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,520 [INFO] ✓ 数据加载成功: 216 条 × 35 列
[2025-11-05T09:56:13.520+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,520 [INFO] 预处理数据...
[2025-11-05T09:56:13.521+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,521 [INFO]   移除ID列: customerID
[2025-11-05T09:56:13.524+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,524 [INFO]   提取日期特征: snapdate
[2025-11-05T09:56:13.529+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,529 [INFO] ✓ 数据预处理完成
[2025-11-05T09:56:13.530+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,529 [INFO] 开始预测...
[2025-11-05T09:56:13.531+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,531 [INFO] 检测到类别列 28 个: ['Churn', 'Contract', 'PaperlessBilling', 'PaymentMethod', 'AutoRenewal', 'BillingCycle', 'DiscountApplied', 'LoyaltyProgramMember', 'PhoneService', 'MultipleLines', 'InternetService', 'OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies', 'SmartHomePackage', 'GamingBundle', 'InternationalCallingPlan', 'CloudStoragePlan', 'gender', 'Partner', 'Dependents', 'EducationLevel', 'EmploymentStatus', 'AnnualIncomeBracket', 'CustomerSatisfactionScore']
[2025-11-05T09:56:13.536+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,536 [INFO] ✓ 预测完成: 216 条记录
[2025-11-05T09:56:13.537+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,536 [INFO] 类别分布: 0=126, 1=90
[2025-11-05T09:56:13.539+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,536 [INFO] 平均预测概率: 0.4125
[2025-11-05T09:56:13.542+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,542 [INFO] ✓ 预测结果已保存: /opt/airflow/model_bank/predictions/predictions_20251105_095613.csv
[2025-11-05T09:56:13.542+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,542 [INFO]
[2025-11-05T09:56:13.543+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:56:13.544+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,542 [INFO] ✅ 预测流程完成！
[2025-11-05T09:56:13.544+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,542 [INFO] ============================================================
[2025-11-05T09:56:13.545+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,542 [INFO]
[2025-11-05T09:56:13.546+0000] {subprocess.py:93} INFO - 预测结果示例（前5行）:
[2025-11-05T09:56:13.547+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,545 [INFO]
[2025-11-05T09:56:13.548+0000] {subprocess.py:93} INFO -    prediction  probability
[2025-11-05T09:56:13.549+0000] {subprocess.py:93} INFO - 0           1     0.853207
[2025-11-05T09:56:13.550+0000] {subprocess.py:93} INFO - 1           1     0.680816
[2025-11-05T09:56:13.551+0000] {subprocess.py:93} INFO - 2           0     0.054123
[2025-11-05T09:56:13.552+0000] {subprocess.py:93} INFO - 3           0     0.414024
[2025-11-05T09:56:13.552+0000] {subprocess.py:93} INFO - 4           1     0.757927
[2025-11-05T09:56:13.583+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,582 [INFO] ============================================================
[2025-11-05T09:56:13.584+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,582 [INFO] CatBoost Gold Price Prediction - 开始预测
[2025-11-05T09:56:13.585+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,582 [INFO] ============================================================
[2025-11-05T09:56:13.586+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,582 [INFO] [auto] ROOT         = /opt/airflow
[2025-11-05T09:56:13.586+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,582 [INFO] [auto] MODEL_PATH   = /opt/airflow/model_bank/catboost/catboost_gold_model.cbm
[2025-11-05T09:56:13.587+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,582 [INFO] [auto] DATA_PATH    = /opt/airflow/datamart/gold/gold_2024_09_01.csv
[2025-11-05T09:56:13.588+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,582 [INFO] [auto] OUTPUT_PATH  = /opt/airflow/model_bank/predictions/predictions_20251105_095613.csv
[2025-11-05T09:56:13.589+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,582 [INFO] 加载模型: /opt/airflow/model_bank/catboost/catboost_gold_model.cbm
[2025-11-05T09:56:13.597+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,597 [INFO] ✓ 模型加载成功
[2025-11-05T09:56:13.599+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,597 [INFO] 加载数据: /opt/airflow/datamart/gold/gold_2024_09_01.csv
[2025-11-05T09:56:13.605+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,605 [INFO] ✓ 数据加载成功: 216 条 × 35 列
[2025-11-05T09:56:13.607+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,605 [INFO] 预处理数据...
[2025-11-05T09:56:13.607+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,606 [INFO]   移除ID列: customerID
[2025-11-05T09:56:13.608+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,608 [INFO]   提取日期特征: snapdate
[2025-11-05T09:56:13.613+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,613 [INFO] ✓ 数据预处理完成
[2025-11-05T09:56:13.615+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,613 [INFO] 开始预测...
[2025-11-05T09:56:13.615+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,615 [INFO] 检测到类别列 28 个: ['Churn', 'Contract', 'PaperlessBilling', 'PaymentMethod', 'AutoRenewal', 'BillingCycle', 'DiscountApplied', 'LoyaltyProgramMember', 'PhoneService', 'MultipleLines', 'InternetService', 'OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies', 'SmartHomePackage', 'GamingBundle', 'InternationalCallingPlan', 'CloudStoragePlan', 'gender', 'Partner', 'Dependents', 'EducationLevel', 'EmploymentStatus', 'AnnualIncomeBracket', 'CustomerSatisfactionScore']
[2025-11-05T09:56:13.618+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,618 [INFO] ✓ 预测完成: 216 条记录
[2025-11-05T09:56:13.619+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,618 [INFO] 类别分布: 0=126, 1=90
[2025-11-05T09:56:13.620+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,618 [INFO] 平均预测概率: 0.4125
[2025-11-05T09:56:13.625+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,625 [INFO] ✓ 预测结果已保存: /opt/airflow/model_bank/predictions/predictions_20251105_095613.csv
[2025-11-05T09:56:13.626+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,625 [INFO]
[2025-11-05T09:56:13.627+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:56:13.627+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,625 [INFO] ✅ 预测流程完成！
[2025-11-05T09:56:13.628+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,625 [INFO] ============================================================
[2025-11-05T09:56:13.630+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,625 [INFO]
[2025-11-05T09:56:13.630+0000] {subprocess.py:93} INFO - 预测结果示例（前5行）:
[2025-11-05T09:56:13.631+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:13,627 [INFO]
[2025-11-05T09:56:13.632+0000] {subprocess.py:93} INFO -    prediction  probability
[2025-11-05T09:56:13.632+0000] {subprocess.py:93} INFO - 0           1     0.853207
[2025-11-05T09:56:13.632+0000] {subprocess.py:93} INFO - 1           1     0.680816
[2025-11-05T09:56:13.633+0000] {subprocess.py:93} INFO - 2           0     0.054123
[2025-11-05T09:56:13.633+0000] {subprocess.py:93} INFO - 3           0     0.414024
[2025-11-05T09:56:13.634+0000] {subprocess.py:93} INFO - 4           1     0.757927
[2025-11-05T09:56:13.675+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-11-05T09:56:13.719+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-11-05T09:56:13.720+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=e2e_pipeline, task_id=catboost_gold_predict, run_id=manual__2025-11-05T09:55:30.974057+00:00, execution_date=20251105T095530, start_date=20251105T095612, end_date=20251105T095613
[2025-11-05T09:56:13.763+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-11-05T09:56:13.790+0000] {taskinstance.py:3900} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-11-05T09:56:13.801+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
