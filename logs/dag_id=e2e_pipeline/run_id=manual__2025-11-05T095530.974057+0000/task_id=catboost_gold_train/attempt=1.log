[2025-11-05T09:56:03.100+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-11-05T09:56:03.117+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: e2e_pipeline.catboost_gold_train manual__2025-11-05T09:55:30.974057+00:00 [queued]>
[2025-11-05T09:56:03.129+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: e2e_pipeline.catboost_gold_train manual__2025-11-05T09:55:30.974057+00:00 [queued]>
[2025-11-05T09:56:03.131+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 1
[2025-11-05T09:56:03.168+0000] {taskinstance.py:2888} INFO - Executing <Task(BashOperator): catboost_gold_train> on 2025-11-05 09:55:30.974057+00:00
[2025-11-05T09:56:03.173+0000] {standard_task_runner.py:72} INFO - Started process 206 to run task
[2025-11-05T09:56:03.181+0000] {standard_task_runner.py:104} INFO - Running: ['airflow', 'tasks', 'run', 'e2e_pipeline', 'catboost_gold_train', 'manual__2025-11-05T09:55:30.974057+00:00', '--job-id', '51', '--raw', '--subdir', 'DAGS_FOLDER/e2e_pipeline_dag.py', '--cfg-path', '/tmp/tmpo84enhca']
[2025-11-05T09:56:03.184+0000] {standard_task_runner.py:105} INFO - Job 51: Subtask catboost_gold_train
[2025-11-05T09:56:03.282+0000] {task_command.py:467} INFO - Running <TaskInstance: e2e_pipeline.catboost_gold_train manual__2025-11-05T09:55:30.974057+00:00 [running]> on host 4fe7252a36f5
[2025-11-05T09:56:03.434+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='e2e_pipeline' AIRFLOW_CTX_TASK_ID='catboost_gold_train' AIRFLOW_CTX_EXECUTION_DATE='2025-11-05T09:55:30.974057+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-11-05T09:55:30.974057+00:00'
[2025-11-05T09:56:03.436+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-11-05T09:56:03.459+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-11-05T09:56:03.461+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'python /opt/airflow/scripts/catboost_gold_train.py']
[2025-11-05T09:56:03.470+0000] {subprocess.py:86} INFO - Output:
[2025-11-05T09:56:05.095+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,095 [INFO] ============================================================
[2025-11-05T09:56:05.096+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,095 [INFO] CatBoost Gold Price Prediction - 开始训练
[2025-11-05T09:56:05.097+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,095 [INFO] ============================================================
[2025-11-05T09:56:05.098+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,096 [INFO]
[2025-11-05T09:56:05.100+0000] {subprocess.py:93} INFO - 配置信息:
[2025-11-05T09:56:05.101+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,096 [INFO]   数据路径: /opt/airflow/datamart/gold
[2025-11-05T09:56:05.101+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,096 [INFO]   输出路径: /opt/airflow/model_bank/catboost
[2025-11-05T09:56:05.102+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,097 [INFO]   训练范围: (2023, 2) - (2024, 4)
[2025-11-05T09:56:05.103+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,098 [INFO]   OOT范围:  (2024, 5) - (2024, 9)
[2025-11-05T09:56:05.104+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,098 [INFO] ============================================================
[2025-11-05T09:56:05.105+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,098 [INFO] 开始读取黄金价格数据...
[2025-11-05T09:56:05.105+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,099 [INFO] ============================================================
[2025-11-05T09:56:05.106+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,099 [INFO]
[2025-11-05T09:56:05.107+0000] {subprocess.py:93} INFO - 训练集: 2023-02 至 2024-04 (共15个月)
[2025-11-05T09:56:05.107+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,099 [INFO] OOT集: 2024-05 至 2024-09 (共5个月)
[2025-11-05T09:56:05.108+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,100 [INFO]
[2025-11-05T09:56:05.108+0000] {subprocess.py:93} INFO - 读取训练集数据...
[2025-11-05T09:56:05.109+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,100 [INFO] ------------------------------------------------------------
[2025-11-05T09:56:05.111+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,111 [INFO]   ✓ gold_2023_02_01.csv: 233 条记录
[2025-11-05T09:56:05.119+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,119 [INFO]   ✓ gold_2023_03_01.csv: 224 条记录
[2025-11-05T09:56:05.127+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,127 [INFO]   ✓ gold_2023_04_01.csv: 228 条记录
[2025-11-05T09:56:05.135+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,134 [INFO]   ✓ gold_2023_05_01.csv: 216 条记录
[2025-11-05T09:56:05.141+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,141 [INFO]   ✓ gold_2023_06_01.csv: 214 条记录
[2025-11-05T09:56:05.148+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,148 [INFO]   ✓ gold_2023_07_01.csv: 219 条记录
[2025-11-05T09:56:05.157+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,156 [INFO]   ✓ gold_2023_08_01.csv: 239 条记录
[2025-11-05T09:56:05.164+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,164 [INFO]   ✓ gold_2023_09_01.csv: 225 条记录
[2025-11-05T09:56:05.171+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,170 [INFO]   ✓ gold_2023_10_01.csv: 215 条记录
[2025-11-05T09:56:05.177+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,177 [INFO]   ✓ gold_2023_11_01.csv: 213 条记录
[2025-11-05T09:56:05.185+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,185 [INFO]   ✓ gold_2023_12_01.csv: 219 条记录
[2025-11-05T09:56:05.193+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,193 [INFO]   ✓ gold_2024_01_01.csv: 232 条记录
[2025-11-05T09:56:05.202+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,201 [INFO]   ✓ gold_2024_02_01.csv: 217 条记录
[2025-11-05T09:56:05.210+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,210 [INFO]   ✓ gold_2024_03_01.csv: 240 条记录
[2025-11-05T09:56:05.221+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,220 [INFO]   ✓ gold_2024_04_01.csv: 230 条记录
[2025-11-05T09:56:05.225+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,225 [INFO]
[2025-11-05T09:56:05.227+0000] {subprocess.py:93} INFO - 训练集合并完成: 3,364 条记录
[2025-11-05T09:56:05.228+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,226 [INFO]
[2025-11-05T09:56:05.229+0000] {subprocess.py:93} INFO - 读取OOT集数据...
[2025-11-05T09:56:05.230+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,226 [INFO] ------------------------------------------------------------
[2025-11-05T09:56:05.235+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,235 [INFO]   ✓ gold_2024_05_01.csv: 210 条记录
[2025-11-05T09:56:05.244+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,243 [INFO]   ✓ gold_2024_06_01.csv: 221 条记录
[2025-11-05T09:56:05.251+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,251 [INFO]   ✓ gold_2024_07_01.csv: 231 条记录
[2025-11-05T09:56:05.258+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,258 [INFO]   ✓ gold_2024_08_01.csv: 221 条记录
[2025-11-05T09:56:05.267+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,266 [INFO]   ✓ gold_2024_09_01.csv: 216 条记录
[2025-11-05T09:56:05.268+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,267 [INFO]
[2025-11-05T09:56:05.270+0000] {subprocess.py:93} INFO - OOT集合并完成: 1,099 条记录
[2025-11-05T09:56:05.271+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,268 [INFO]
[2025-11-05T09:56:05.271+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:56:05.272+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,268 [INFO] 数据加载完成!
[2025-11-05T09:56:05.273+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,268 [INFO] ============================================================
[2025-11-05T09:56:05.274+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,269 [INFO]
[2025-11-05T09:56:05.275+0000] {subprocess.py:93} INFO - 训练集: 3,364 条 × 38 列
[2025-11-05T09:56:05.276+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,269 [INFO] OOT集:  1,099 条 × 38 列
[2025-11-05T09:56:05.277+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,271 [INFO]
[2025-11-05T09:56:05.278+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:56:05.279+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,271 [INFO] 开始数据预处理...
[2025-11-05T09:56:05.280+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,272 [INFO] ============================================================
[2025-11-05T09:56:05.280+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,277 [INFO] ✓ 找到目标变量: Churn
[2025-11-05T09:56:05.281+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,278 [INFO] ✓ 目标变量转换完成 (Yes/No -> 1/0)
[2025-11-05T09:56:05.281+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,279 [INFO]
[2025-11-05T09:56:05.282+0000] {subprocess.py:93} INFO - 目标变量分布:
[2025-11-05T09:56:05.282+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,279 [INFO] Churn
[2025-11-05T09:56:05.283+0000] {subprocess.py:93} INFO - 0    3262
[2025-11-05T09:56:05.283+0000] {subprocess.py:93} INFO - 1    1201
[2025-11-05T09:56:05.284+0000] {subprocess.py:93} INFO - Name: count, dtype: int64
[2025-11-05T09:56:05.285+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,280 [INFO] 正样本比例: 26.91%
[2025-11-05T09:56:05.285+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,281 [INFO] ✓ 已移除ID列: customerID
[2025-11-05T09:56:05.286+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,286 [INFO] ✓ 日期特征提取完成: snapdate
[2025-11-05T09:56:05.287+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,287 [INFO] ✓ 数值型缺失值填充完成
[2025-11-05T09:56:05.293+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,293 [INFO] ✓ 类别型缺失值填充完成
[2025-11-05T09:56:05.294+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,293 [INFO]
[2025-11-05T09:56:05.295+0000] {subprocess.py:93} INFO - ------------------------------------------------------------
[2025-11-05T09:56:05.296+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,294 [INFO] 识别和处理类别特征...
[2025-11-05T09:56:05.297+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,294 [INFO] ------------------------------------------------------------
[2025-11-05T09:56:05.299+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,299 [INFO] ✓ 识别到 27 个类别特征
[2025-11-05T09:56:05.300+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,299 [INFO] 类别特征: ['Contract', 'PaperlessBilling', 'PaymentMethod', 'AutoRenewal', 'BillingCycle', 'DiscountApplied', 'LoyaltyProgramMember', 'PhoneService', 'MultipleLines', 'InternetService']...
[2025-11-05T09:56:05.300+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,299 [INFO]
[2025-11-05T09:56:05.301+0000] {subprocess.py:93} INFO - ✓ 数据预处理完成，当前数据维度: (4463, 39)
[2025-11-05T09:56:05.301+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,300 [INFO]
[2025-11-05T09:56:05.302+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:56:05.302+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,300 [INFO] 准备训练数据...
[2025-11-05T09:56:05.303+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,300 [INFO] ============================================================
[2025-11-05T09:56:05.306+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,306 [INFO]
[2025-11-05T09:56:05.307+0000] {subprocess.py:93} INFO - 时间范围分布:
[2025-11-05T09:56:05.308+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,306 [INFO]   训练+验证集: 3364 条
[2025-11-05T09:56:05.309+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,307 [INFO]   OOT集: 2018 条
[2025-11-05T09:56:05.311+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,311 [INFO]
[2025-11-05T09:56:05.312+0000] {subprocess.py:93} INFO - 最终划分:
[2025-11-05T09:56:05.313+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,311 [INFO]   训练集: (2691, 35)
[2025-11-05T09:56:05.314+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,312 [INFO]   验证集: (673, 35)
[2025-11-05T09:56:05.315+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,312 [INFO]   OOT集: (2018, 35)
[2025-11-05T09:56:05.316+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,313 [INFO]
[2025-11-05T09:56:05.316+0000] {subprocess.py:93} INFO - 类别特征索引: 27 个
[2025-11-05T09:56:05.317+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,313 [INFO]
[2025-11-05T09:56:05.318+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:56:05.319+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,313 [INFO] 训练CatBoost模型...
[2025-11-05T09:56:05.320+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,314 [INFO] ============================================================
[2025-11-05T09:56:05.320+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,314 [INFO] 模型配置:
[2025-11-05T09:56:05.320+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,314 [INFO]   - iterations: 1000
[2025-11-05T09:56:05.321+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,314 [INFO]   - learning_rate: 0.03
[2025-11-05T09:56:05.322+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,315 [INFO]   - depth: 6
[2025-11-05T09:56:05.323+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,315 [INFO]   - cat_features: 27 个
[2025-11-05T09:56:05.324+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,315 [INFO]
[2025-11-05T09:56:05.324+0000] {subprocess.py:93} INFO - 开始训练...
[2025-11-05T09:56:05.325+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:05,315 [INFO] ------------------------------------------------------------
[2025-11-05T09:56:07.682+0000] {subprocess.py:93} INFO - 0:	test: 0.7885158	best: 0.7885158 (0)	total: 61.9ms	remaining: 1m 1s
[2025-11-05T09:56:07.683+0000] {subprocess.py:93} INFO - 100:	test: 0.8228750	best: 0.8232306 (96)	total: 893ms	remaining: 7.95s
[2025-11-05T09:56:07.684+0000] {subprocess.py:93} INFO - 200:	test: 0.8284876	best: 0.8288099 (197)	total: 1.49s	remaining: 5.92s
[2025-11-05T09:56:07.685+0000] {subprocess.py:93} INFO - 300:	test: 0.8301214	best: 0.8305215 (286)	total: 2.05s	remaining: 4.77s
[2025-11-05T09:56:07.686+0000] {subprocess.py:93} INFO - Stopped by overfitting detector  (50 iterations wait)
[2025-11-05T09:56:07.688+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:56:07.689+0000] {subprocess.py:93} INFO - bestTest = 0.8305214724
[2025-11-05T09:56:07.690+0000] {subprocess.py:93} INFO - bestIteration = 286
[2025-11-05T09:56:07.690+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:56:07.692+0000] {subprocess.py:93} INFO - Shrink model to first 287 iterations.
[2025-11-05T09:56:07.693+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,682 [INFO]
[2025-11-05T09:56:07.694+0000] {subprocess.py:93} INFO - ✓ 模型训练完成！
[2025-11-05T09:56:07.695+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,682 [INFO] ✓ 最佳迭代次数: 286
[2025-11-05T09:56:07.695+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,682 [INFO] ✓ 最佳验证AUC: 0.8305
[2025-11-05T09:56:07.696+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,682 [INFO]
[2025-11-05T09:56:07.696+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:56:07.697+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,683 [INFO] 模型评估...
[2025-11-05T09:56:07.698+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,683 [INFO] ============================================================
[2025-11-05T09:56:07.698+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,693 [INFO]
[2025-11-05T09:56:07.699+0000] {subprocess.py:93} INFO - 验证集评估:
[2025-11-05T09:56:07.700+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,694 [INFO] ============================================================
[2025-11-05T09:56:07.701+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,699 [INFO]
[2025-11-05T09:56:07.702+0000] {subprocess.py:93} INFO -               precision    recall  f1-score   support
[2025-11-05T09:56:07.703+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:56:07.704+0000] {subprocess.py:93} INFO -            0       0.91      0.70      0.79       489
[2025-11-05T09:56:07.705+0000] {subprocess.py:93} INFO -            1       0.50      0.81      0.62       184
[2025-11-05T09:56:07.706+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:56:07.708+0000] {subprocess.py:93} INFO -     accuracy                           0.73       673
[2025-11-05T09:56:07.708+0000] {subprocess.py:93} INFO -    macro avg       0.71      0.75      0.71       673
[2025-11-05T09:56:07.709+0000] {subprocess.py:93} INFO - weighted avg       0.80      0.73      0.74       673
[2025-11-05T09:56:07.711+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:56:07.712+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,702 [INFO]
[2025-11-05T09:56:07.713+0000] {subprocess.py:93} INFO - 核心指标:
[2025-11-05T09:56:07.715+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,702 [INFO]   Accuracy: 0.7296
[2025-11-05T09:56:07.715+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,703 [INFO]   AUC-ROC:  0.8305
[2025-11-05T09:56:07.716+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,703 [INFO]
[2025-11-05T09:56:07.716+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:56:07.717+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,703 [INFO] OOT集评估:
[2025-11-05T09:56:07.717+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,704 [INFO] ============================================================
[2025-11-05T09:56:07.731+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,731 [INFO]
[2025-11-05T09:56:07.733+0000] {subprocess.py:93} INFO -               precision    recall  f1-score   support
[2025-11-05T09:56:07.734+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:56:07.735+0000] {subprocess.py:93} INFO -            0       0.92      0.73      0.81      1488
[2025-11-05T09:56:07.735+0000] {subprocess.py:93} INFO -            1       0.51      0.82      0.63       530
[2025-11-05T09:56:07.736+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:56:07.737+0000] {subprocess.py:93} INFO -     accuracy                           0.75      2018
[2025-11-05T09:56:07.738+0000] {subprocess.py:93} INFO -    macro avg       0.72      0.77      0.72      2018
[2025-11-05T09:56:07.740+0000] {subprocess.py:93} INFO - weighted avg       0.81      0.75      0.76      2018
[2025-11-05T09:56:07.741+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:56:07.742+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,734 [INFO]
[2025-11-05T09:56:07.743+0000] {subprocess.py:93} INFO - 核心指标:
[2025-11-05T09:56:07.743+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,734 [INFO]   Accuracy: 0.7498
[2025-11-05T09:56:07.745+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,734 [INFO]   AUC-ROC:  0.8569
[2025-11-05T09:56:07.746+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,735 [INFO]
[2025-11-05T09:56:07.747+0000] {subprocess.py:93} INFO - 模型稳定性 (PSI): 0.0146
[2025-11-05T09:56:07.748+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,735 [INFO]   ✓ PSI < 0.1: 模型稳定性良好
[2025-11-05T09:56:07.749+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,735 [INFO]
[2025-11-05T09:56:07.750+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:56:07.751+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,735 [INFO] 保存模型和结果...
[2025-11-05T09:56:07.752+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,735 [INFO] ============================================================
[2025-11-05T09:56:07.758+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,757 [INFO] ✓ 模型已保存: /opt/airflow/model_bank/catboost/catboost_gold_model.cbm
[2025-11-05T09:56:07.766+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,766 [INFO] ✓ 特征重要性已保存: /opt/airflow/model_bank/catboost/feature_importance.csv
[2025-11-05T09:56:07.771+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,771 [INFO] ✓ 预测结果已保存: /opt/airflow/model_bank/catboost/predictions.csv
[2025-11-05T09:56:07.775+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,774 [INFO] ✓ 评估指标已保存: /opt/airflow/model_bank/catboost/model_metrics.csv
[2025-11-05T09:56:07.775+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,775 [INFO]
[2025-11-05T09:56:07.777+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:56:07.778+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,775 [INFO] ✅ 所有结果已保存!
[2025-11-05T09:56:07.779+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,775 [INFO] ============================================================
[2025-11-05T09:56:07.780+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,775 [INFO]
[2025-11-05T09:56:07.781+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:56:07.782+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,775 [INFO] ✅ 训练流程全部完成！
[2025-11-05T09:56:07.783+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,775 [INFO] ============================================================
[2025-11-05T09:56:07.784+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,776 [INFO]
[2025-11-05T09:56:07.785+0000] {subprocess.py:93} INFO - 生成的文件位于: /opt/airflow/model_bank/catboost
[2025-11-05T09:56:07.785+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,776 [INFO]
[2025-11-05T09:56:07.786+0000] {subprocess.py:93} INFO - 模型加载示例:
[2025-11-05T09:56:07.787+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,777 [INFO]   from catboost import CatBoostClassifier
[2025-11-05T09:56:07.788+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,777 [INFO]   model = CatBoostClassifier()
[2025-11-05T09:56:07.788+0000] {subprocess.py:93} INFO - 2025-11-05 09:56:07,777 [INFO]   model.load_model('/opt/airflow/model_bank/catboost/catboost_gold_model.cbm')
[2025-11-05T09:56:07.914+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-11-05T09:56:07.954+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-11-05T09:56:07.955+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=e2e_pipeline, task_id=catboost_gold_train, run_id=manual__2025-11-05T09:55:30.974057+00:00, execution_date=20251105T095530, start_date=20251105T095603, end_date=20251105T095607
[2025-11-05T09:56:08.022+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-11-05T09:56:08.053+0000] {taskinstance.py:3900} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-11-05T09:56:08.064+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
