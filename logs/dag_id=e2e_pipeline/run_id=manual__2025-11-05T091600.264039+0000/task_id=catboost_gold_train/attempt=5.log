[2025-11-05T09:26:19.738+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-11-05T09:26:19.753+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: e2e_pipeline.catboost_gold_train manual__2025-11-05T09:16:00.264039+00:00 [queued]>
[2025-11-05T09:26:19.764+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: e2e_pipeline.catboost_gold_train manual__2025-11-05T09:16:00.264039+00:00 [queued]>
[2025-11-05T09:26:19.765+0000] {taskinstance.py:2865} INFO - Starting attempt 5 of 5
[2025-11-05T09:26:19.790+0000] {taskinstance.py:2888} INFO - Executing <Task(BashOperator): catboost_gold_train> on 2025-11-05 09:16:00.264039+00:00
[2025-11-05T09:26:19.795+0000] {standard_task_runner.py:72} INFO - Started process 447 to run task
[2025-11-05T09:26:19.799+0000] {standard_task_runner.py:104} INFO - Running: ['airflow', 'tasks', 'run', 'e2e_pipeline', 'catboost_gold_train', 'manual__2025-11-05T09:16:00.264039+00:00', '--job-id', '39', '--raw', '--subdir', 'DAGS_FOLDER/e2e_pipeline_dag.py', '--cfg-path', '/tmp/tmpt1rjt108']
[2025-11-05T09:26:19.803+0000] {standard_task_runner.py:105} INFO - Job 39: Subtask catboost_gold_train
[2025-11-05T09:26:19.882+0000] {task_command.py:467} INFO - Running <TaskInstance: e2e_pipeline.catboost_gold_train manual__2025-11-05T09:16:00.264039+00:00 [running]> on host 9d186853eb29
[2025-11-05T09:26:19.968+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='e2e_pipeline' AIRFLOW_CTX_TASK_ID='catboost_gold_train' AIRFLOW_CTX_EXECUTION_DATE='2025-11-05T09:16:00.264039+00:00' AIRFLOW_CTX_TRY_NUMBER='5' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-11-05T09:16:00.264039+00:00'
[2025-11-05T09:26:19.969+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-11-05T09:26:19.980+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-11-05T09:26:19.982+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'python /opt/airflow/scripts/catboost_gold_train.py']
[2025-11-05T09:26:19.991+0000] {subprocess.py:86} INFO - Output:
[2025-11-05T09:26:21.406+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,405 [INFO] ============================================================
[2025-11-05T09:26:21.408+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,405 [INFO] CatBoost Gold Price Prediction - 开始训练
[2025-11-05T09:26:21.409+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,406 [INFO] ============================================================
[2025-11-05T09:26:21.410+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,406 [INFO]
[2025-11-05T09:26:21.411+0000] {subprocess.py:93} INFO - 配置信息:
[2025-11-05T09:26:21.412+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,406 [INFO]   数据路径: /opt/airflow/datamart/gold
[2025-11-05T09:26:21.413+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,406 [INFO]   输出路径: /opt/airflow/model_bank/catboost
[2025-11-05T09:26:21.414+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,407 [INFO]   训练范围: (2023, 2) - (2024, 4)
[2025-11-05T09:26:21.415+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,407 [INFO]   OOT范围:  (2024, 5) - (2024, 9)
[2025-11-05T09:26:21.415+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,407 [INFO] ============================================================
[2025-11-05T09:26:21.416+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,408 [INFO] 开始读取黄金价格数据...
[2025-11-05T09:26:21.417+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,408 [INFO] ============================================================
[2025-11-05T09:26:21.417+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,408 [INFO]
[2025-11-05T09:26:21.418+0000] {subprocess.py:93} INFO - 训练集: 2023-02 至 2024-04 (共15个月)
[2025-11-05T09:26:21.418+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,408 [INFO] OOT集: 2024-05 至 2024-09 (共5个月)
[2025-11-05T09:26:21.419+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,408 [INFO]
[2025-11-05T09:26:21.419+0000] {subprocess.py:93} INFO - 读取训练集数据...
[2025-11-05T09:26:21.420+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,408 [INFO] ------------------------------------------------------------
[2025-11-05T09:26:21.421+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,418 [INFO]   ✓ gold_2023_02_01.csv: 233 条记录
[2025-11-05T09:26:21.424+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,424 [INFO]   ✓ gold_2023_03_01.csv: 224 条记录
[2025-11-05T09:26:21.430+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,430 [INFO]   ✓ gold_2023_04_01.csv: 228 条记录
[2025-11-05T09:26:21.435+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,435 [INFO]   ✓ gold_2023_05_01.csv: 216 条记录
[2025-11-05T09:26:21.440+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,440 [INFO]   ✓ gold_2023_06_01.csv: 214 条记录
[2025-11-05T09:26:21.449+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,448 [INFO]   ✓ gold_2023_07_01.csv: 219 条记录
[2025-11-05T09:26:21.454+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,454 [INFO]   ✓ gold_2023_08_01.csv: 239 条记录
[2025-11-05T09:26:21.461+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,460 [INFO]   ✓ gold_2023_09_01.csv: 225 条记录
[2025-11-05T09:26:21.466+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,465 [INFO]   ✓ gold_2023_10_01.csv: 215 条记录
[2025-11-05T09:26:21.473+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,472 [INFO]   ✓ gold_2023_11_01.csv: 213 条记录
[2025-11-05T09:26:21.479+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,478 [INFO]   ✓ gold_2023_12_01.csv: 219 条记录
[2025-11-05T09:26:21.484+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,484 [INFO]   ✓ gold_2024_01_01.csv: 232 条记录
[2025-11-05T09:26:21.490+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,490 [INFO]   ✓ gold_2024_02_01.csv: 217 条记录
[2025-11-05T09:26:21.496+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,495 [INFO]   ✓ gold_2024_03_01.csv: 240 条记录
[2025-11-05T09:26:21.502+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,501 [INFO]   ✓ gold_2024_04_01.csv: 230 条记录
[2025-11-05T09:26:21.504+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,503 [INFO]
[2025-11-05T09:26:21.505+0000] {subprocess.py:93} INFO - 训练集合并完成: 3,364 条记录
[2025-11-05T09:26:21.506+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,504 [INFO]
[2025-11-05T09:26:21.507+0000] {subprocess.py:93} INFO - 读取OOT集数据...
[2025-11-05T09:26:21.507+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,504 [INFO] ------------------------------------------------------------
[2025-11-05T09:26:21.509+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,509 [INFO]   ✓ gold_2024_05_01.csv: 210 条记录
[2025-11-05T09:26:21.514+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,514 [INFO]   ✓ gold_2024_06_01.csv: 221 条记录
[2025-11-05T09:26:21.520+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,519 [INFO]   ✓ gold_2024_07_01.csv: 231 条记录
[2025-11-05T09:26:21.525+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,524 [INFO]   ✓ gold_2024_08_01.csv: 221 条记录
[2025-11-05T09:26:21.529+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,529 [INFO]   ✓ gold_2024_09_01.csv: 216 条记录
[2025-11-05T09:26:21.530+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,530 [INFO]
[2025-11-05T09:26:21.531+0000] {subprocess.py:93} INFO - OOT集合并完成: 1,099 条记录
[2025-11-05T09:26:21.531+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,530 [INFO]
[2025-11-05T09:26:21.532+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:26:21.533+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,530 [INFO] 数据加载完成!
[2025-11-05T09:26:21.533+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,531 [INFO] ============================================================
[2025-11-05T09:26:21.534+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,531 [INFO]
[2025-11-05T09:26:21.534+0000] {subprocess.py:93} INFO - 训练集: 3,364 条 × 38 列
[2025-11-05T09:26:21.535+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,531 [INFO] OOT集:  1,099 条 × 38 列
[2025-11-05T09:26:21.536+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,532 [INFO]
[2025-11-05T09:26:21.536+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:26:21.537+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,533 [INFO] 开始数据预处理...
[2025-11-05T09:26:21.537+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,533 [INFO] ============================================================
[2025-11-05T09:26:21.538+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,538 [INFO] ✓ 找到目标变量: Churn
[2025-11-05T09:26:21.540+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,540 [INFO] ✓ 目标变量转换完成 (Yes/No -> 1/0)
[2025-11-05T09:26:21.541+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,540 [INFO]
[2025-11-05T09:26:21.541+0000] {subprocess.py:93} INFO - 目标变量分布:
[2025-11-05T09:26:21.542+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,541 [INFO] Churn
[2025-11-05T09:26:21.543+0000] {subprocess.py:93} INFO - 0    3262
[2025-11-05T09:26:21.543+0000] {subprocess.py:93} INFO - 1    1201
[2025-11-05T09:26:21.544+0000] {subprocess.py:93} INFO - Name: count, dtype: int64
[2025-11-05T09:26:21.544+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,541 [INFO] 正样本比例: 26.91%
[2025-11-05T09:26:21.545+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,542 [INFO] ✓ 已移除ID列: customerID
[2025-11-05T09:26:21.547+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,546 [INFO] ✓ 日期特征提取完成: snapdate
[2025-11-05T09:26:21.548+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,548 [INFO] ✓ 数值型缺失值填充完成
[2025-11-05T09:26:21.554+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,553 [INFO] ✓ 类别型缺失值填充完成
[2025-11-05T09:26:21.555+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,554 [INFO]
[2025-11-05T09:26:21.556+0000] {subprocess.py:93} INFO - ------------------------------------------------------------
[2025-11-05T09:26:21.557+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,554 [INFO] 识别和处理类别特征...
[2025-11-05T09:26:21.558+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,555 [INFO] ------------------------------------------------------------
[2025-11-05T09:26:21.559+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,559 [INFO] ✓ 识别到 27 个类别特征
[2025-11-05T09:26:21.560+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,559 [INFO] 类别特征: ['Contract', 'PaperlessBilling', 'PaymentMethod', 'AutoRenewal', 'BillingCycle', 'DiscountApplied', 'LoyaltyProgramMember', 'PhoneService', 'MultipleLines', 'InternetService']...
[2025-11-05T09:26:21.561+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,560 [INFO]
[2025-11-05T09:26:21.562+0000] {subprocess.py:93} INFO - ✓ 数据预处理完成，当前数据维度: (4463, 39)
[2025-11-05T09:26:21.562+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,560 [INFO]
[2025-11-05T09:26:21.563+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:26:21.563+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,561 [INFO] 准备训练数据...
[2025-11-05T09:26:21.564+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,561 [INFO] ============================================================
[2025-11-05T09:26:21.567+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,566 [INFO]
[2025-11-05T09:26:21.568+0000] {subprocess.py:93} INFO - 时间范围分布:
[2025-11-05T09:26:21.568+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,567 [INFO]   训练+验证集: 3364 条
[2025-11-05T09:26:21.569+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,567 [INFO]   OOT集: 2018 条
[2025-11-05T09:26:21.571+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,571 [INFO]
[2025-11-05T09:26:21.572+0000] {subprocess.py:93} INFO - 最终划分:
[2025-11-05T09:26:21.573+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,571 [INFO]   训练集: (2691, 35)
[2025-11-05T09:26:21.574+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,571 [INFO]   验证集: (673, 35)
[2025-11-05T09:26:21.574+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,572 [INFO]   OOT集: (2018, 35)
[2025-11-05T09:26:21.575+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,572 [INFO]
[2025-11-05T09:26:21.575+0000] {subprocess.py:93} INFO - 类别特征索引: 27 个
[2025-11-05T09:26:21.576+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,573 [INFO]
[2025-11-05T09:26:21.577+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:26:21.577+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,573 [INFO] 训练CatBoost模型...
[2025-11-05T09:26:21.578+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,573 [INFO] ============================================================
[2025-11-05T09:26:21.579+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,573 [INFO] 模型配置:
[2025-11-05T09:26:21.580+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,574 [INFO]   - iterations: 1000
[2025-11-05T09:26:21.580+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,574 [INFO]   - learning_rate: 0.03
[2025-11-05T09:26:21.581+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,574 [INFO]   - depth: 6
[2025-11-05T09:26:21.581+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,574 [INFO]   - cat_features: 27 个
[2025-11-05T09:26:21.582+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,574 [INFO]
[2025-11-05T09:26:21.583+0000] {subprocess.py:93} INFO - 开始训练...
[2025-11-05T09:26:21.583+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:21,575 [INFO] ------------------------------------------------------------
[2025-11-05T09:26:23.959+0000] {subprocess.py:93} INFO - 0:	test: 0.7885158	best: 0.7885158 (0)	total: 60.8ms	remaining: 1m
[2025-11-05T09:26:23.960+0000] {subprocess.py:93} INFO - 100:	test: 0.8228750	best: 0.8232306 (96)	total: 728ms	remaining: 6.48s
[2025-11-05T09:26:23.961+0000] {subprocess.py:93} INFO - 200:	test: 0.8284876	best: 0.8288099 (197)	total: 1.42s	remaining: 5.65s
[2025-11-05T09:26:23.961+0000] {subprocess.py:93} INFO - 300:	test: 0.8301214	best: 0.8305215 (286)	total: 2.06s	remaining: 4.79s
[2025-11-05T09:26:23.962+0000] {subprocess.py:93} INFO - Stopped by overfitting detector  (50 iterations wait)
[2025-11-05T09:26:23.962+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:26:23.963+0000] {subprocess.py:93} INFO - bestTest = 0.8305214724
[2025-11-05T09:26:23.964+0000] {subprocess.py:93} INFO - bestIteration = 286
[2025-11-05T09:26:23.965+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:26:23.966+0000] {subprocess.py:93} INFO - Shrink model to first 287 iterations.
[2025-11-05T09:26:23.967+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:23,958 [INFO]
[2025-11-05T09:26:23.967+0000] {subprocess.py:93} INFO - ✓ 模型训练完成！
[2025-11-05T09:26:23.969+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:23,959 [INFO] ✓ 最佳迭代次数: 286
[2025-11-05T09:26:23.970+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:23,959 [INFO] ✓ 最佳验证AUC: 0.8305
[2025-11-05T09:26:23.970+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:23,959 [INFO]
[2025-11-05T09:26:23.971+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:26:23.972+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:23,960 [INFO] 模型评估...
[2025-11-05T09:26:23.972+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:23,960 [INFO] ============================================================
[2025-11-05T09:26:23.973+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:23,970 [INFO]
[2025-11-05T09:26:23.974+0000] {subprocess.py:93} INFO - 验证集评估:
[2025-11-05T09:26:23.974+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:23,970 [INFO] ============================================================
[2025-11-05T09:26:23.976+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:23,976 [INFO]
[2025-11-05T09:26:23.977+0000] {subprocess.py:93} INFO -               precision    recall  f1-score   support
[2025-11-05T09:26:23.978+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:26:23.978+0000] {subprocess.py:93} INFO -            0       0.91      0.70      0.79       489
[2025-11-05T09:26:23.979+0000] {subprocess.py:93} INFO -            1       0.50      0.81      0.62       184
[2025-11-05T09:26:23.979+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:26:23.980+0000] {subprocess.py:93} INFO -     accuracy                           0.73       673
[2025-11-05T09:26:23.981+0000] {subprocess.py:93} INFO -    macro avg       0.71      0.75      0.71       673
[2025-11-05T09:26:23.981+0000] {subprocess.py:93} INFO - weighted avg       0.80      0.73      0.74       673
[2025-11-05T09:26:23.982+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:26:23.982+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:23,979 [INFO]
[2025-11-05T09:26:23.983+0000] {subprocess.py:93} INFO - 核心指标:
[2025-11-05T09:26:23.984+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:23,979 [INFO]   Accuracy: 0.7296
[2025-11-05T09:26:23.984+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:23,979 [INFO]   AUC-ROC:  0.8305
[2025-11-05T09:26:23.985+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:23,979 [INFO]
[2025-11-05T09:26:23.986+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:26:23.986+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:23,979 [INFO] OOT集评估:
[2025-11-05T09:26:23.987+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:23,979 [INFO] ============================================================
[2025-11-05T09:26:24.007+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,006 [INFO]
[2025-11-05T09:26:24.008+0000] {subprocess.py:93} INFO -               precision    recall  f1-score   support
[2025-11-05T09:26:24.009+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:26:24.010+0000] {subprocess.py:93} INFO -            0       0.92      0.73      0.81      1488
[2025-11-05T09:26:24.010+0000] {subprocess.py:93} INFO -            1       0.51      0.82      0.63       530
[2025-11-05T09:26:24.011+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:26:24.012+0000] {subprocess.py:93} INFO -     accuracy                           0.75      2018
[2025-11-05T09:26:24.012+0000] {subprocess.py:93} INFO -    macro avg       0.72      0.77      0.72      2018
[2025-11-05T09:26:24.013+0000] {subprocess.py:93} INFO - weighted avg       0.81      0.75      0.76      2018
[2025-11-05T09:26:24.013+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:26:24.014+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,010 [INFO]
[2025-11-05T09:26:24.015+0000] {subprocess.py:93} INFO - 核心指标:
[2025-11-05T09:26:24.015+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,010 [INFO]   Accuracy: 0.7498
[2025-11-05T09:26:24.016+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,010 [INFO]   AUC-ROC:  0.8569
[2025-11-05T09:26:24.016+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,011 [INFO]
[2025-11-05T09:26:24.017+0000] {subprocess.py:93} INFO - 模型稳定性 (PSI): 0.0146
[2025-11-05T09:26:24.018+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,011 [INFO]   ✓ PSI < 0.1: 模型稳定性良好
[2025-11-05T09:26:24.019+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,012 [INFO]
[2025-11-05T09:26:24.020+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:26:24.020+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,012 [INFO] 保存模型和结果...
[2025-11-05T09:26:24.021+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,012 [INFO] ============================================================
[2025-11-05T09:26:24.049+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,049 [INFO] ✓ 模型已保存: /opt/airflow/model_bank/catboost/catboost_gold_model.cbm
[2025-11-05T09:26:24.076+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,075 [INFO] ✓ 特征重要性已保存: /opt/airflow/model_bank/catboost/feature_importance.csv
[2025-11-05T09:26:24.093+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,092 [INFO] ✓ 预测结果已保存: /opt/airflow/model_bank/catboost/predictions.csv
[2025-11-05T09:26:24.106+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,106 [INFO] ✓ 评估指标已保存: /opt/airflow/model_bank/catboost/model_metrics.csv
[2025-11-05T09:26:24.108+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,106 [INFO]
[2025-11-05T09:26:24.109+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:26:24.110+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,107 [INFO] ✅ 所有结果已保存!
[2025-11-05T09:26:24.111+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,107 [INFO] ============================================================
[2025-11-05T09:26:24.111+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,107 [INFO]
[2025-11-05T09:26:24.112+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:26:24.113+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,108 [INFO] ✅ 训练流程全部完成！
[2025-11-05T09:26:24.113+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,108 [INFO] ============================================================
[2025-11-05T09:26:24.114+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,109 [INFO]
[2025-11-05T09:26:24.115+0000] {subprocess.py:93} INFO - 生成的文件位于: /opt/airflow/model_bank/catboost
[2025-11-05T09:26:24.116+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,109 [INFO]
[2025-11-05T09:26:24.117+0000] {subprocess.py:93} INFO - 模型加载示例:
[2025-11-05T09:26:24.118+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,109 [INFO]   from catboost import CatBoostClassifier
[2025-11-05T09:26:24.119+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,109 [INFO]   model = CatBoostClassifier()
[2025-11-05T09:26:24.119+0000] {subprocess.py:93} INFO - 2025-11-05 09:26:24,109 [INFO]   model.load_model('/opt/airflow/model_bank/catboost/catboost_gold_model.cbm')
[2025-11-05T09:26:24.251+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-11-05T09:26:24.287+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-11-05T09:26:24.288+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=e2e_pipeline, task_id=catboost_gold_train, run_id=manual__2025-11-05T09:16:00.264039+00:00, execution_date=20251105T091600, start_date=20251105T092619, end_date=20251105T092624
[2025-11-05T09:26:24.357+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-11-05T09:26:24.389+0000] {taskinstance.py:3900} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-11-05T09:26:24.402+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
