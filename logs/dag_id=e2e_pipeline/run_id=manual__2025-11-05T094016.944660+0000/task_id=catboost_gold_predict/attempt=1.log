[2025-11-05T09:41:09.305+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-11-05T09:41:09.325+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: e2e_pipeline.catboost_gold_predict manual__2025-11-05T09:40:16.944660+00:00 [queued]>
[2025-11-05T09:41:09.342+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: e2e_pipeline.catboost_gold_predict manual__2025-11-05T09:40:16.944660+00:00 [queued]>
[2025-11-05T09:41:09.344+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 1
[2025-11-05T09:41:09.386+0000] {taskinstance.py:2888} INFO - Executing <Task(BashOperator): catboost_gold_predict> on 2025-11-05 09:40:16.944660+00:00
[2025-11-05T09:41:09.393+0000] {standard_task_runner.py:72} INFO - Started process 1147 to run task
[2025-11-05T09:41:09.400+0000] {standard_task_runner.py:104} INFO - Running: ['airflow', 'tasks', 'run', 'e2e_pipeline', 'catboost_gold_predict', 'manual__2025-11-05T09:40:16.944660+00:00', '--job-id', '50', '--raw', '--subdir', 'DAGS_FOLDER/e2e_pipeline_dag.py', '--cfg-path', '/tmp/tmpjnt0b9ms']
[2025-11-05T09:41:09.404+0000] {standard_task_runner.py:105} INFO - Job 50: Subtask catboost_gold_predict
[2025-11-05T09:41:09.505+0000] {task_command.py:467} INFO - Running <TaskInstance: e2e_pipeline.catboost_gold_predict manual__2025-11-05T09:40:16.944660+00:00 [running]> on host 9d186853eb29
[2025-11-05T09:41:09.625+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='e2e_pipeline' AIRFLOW_CTX_TASK_ID='catboost_gold_predict' AIRFLOW_CTX_EXECUTION_DATE='2025-11-05T09:40:16.944660+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-11-05T09:40:16.944660+00:00'
[2025-11-05T09:41:09.626+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-11-05T09:41:09.640+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-11-05T09:41:09.643+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'python /opt/airflow/scripts/catboost_gold_predict.py']
[2025-11-05T09:41:09.652+0000] {subprocess.py:86} INFO - Output:
[2025-11-05T09:41:11.031+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,031 [INFO] ============================================================
[2025-11-05T09:41:11.032+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,031 [INFO] CatBoost Gold Price Prediction - 开始预测
[2025-11-05T09:41:11.033+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,031 [INFO] ============================================================
[2025-11-05T09:41:11.034+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,031 [INFO] [auto] ROOT         = /opt/airflow
[2025-11-05T09:41:11.035+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,031 [INFO] [auto] MODEL_PATH   = /opt/airflow/model_bank/catboost/catboost_gold_model.cbm
[2025-11-05T09:41:11.036+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,031 [INFO] [auto] DATA_PATH    = /opt/airflow/datamart/gold/gold_2024_09_01.csv
[2025-11-05T09:41:11.037+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,031 [INFO] [auto] OUTPUT_PATH  = /opt/airflow/model_bank/predictions/predictions_20251105_094111.csv
[2025-11-05T09:41:11.037+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,031 [INFO] 加载模型: /opt/airflow/model_bank/catboost/catboost_gold_model.cbm
[2025-11-05T09:41:11.046+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,046 [INFO] ✓ 模型加载成功
[2025-11-05T09:41:11.047+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,046 [INFO] 加载数据: /opt/airflow/datamart/gold/gold_2024_09_01.csv
[2025-11-05T09:41:11.056+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,056 [INFO] ✓ 数据加载成功: 216 条 × 35 列
[2025-11-05T09:41:11.057+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,056 [INFO] 预处理数据...
[2025-11-05T09:41:11.058+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,057 [INFO]   移除ID列: customerID
[2025-11-05T09:41:11.063+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,062 [INFO]   提取日期特征: snapdate
[2025-11-05T09:41:11.073+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,073 [INFO] ✓ 数据预处理完成
[2025-11-05T09:41:11.074+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,073 [INFO] 开始预测...
[2025-11-05T09:41:11.075+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,075 [INFO] 检测到类别列 28 个: ['Churn', 'Contract', 'PaperlessBilling', 'PaymentMethod', 'AutoRenewal', 'BillingCycle', 'DiscountApplied', 'LoyaltyProgramMember', 'PhoneService', 'MultipleLines', 'InternetService', 'OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies', 'SmartHomePackage', 'GamingBundle', 'InternationalCallingPlan', 'CloudStoragePlan', 'gender', 'Partner', 'Dependents', 'EducationLevel', 'EmploymentStatus', 'AnnualIncomeBracket', 'CustomerSatisfactionScore']
[2025-11-05T09:41:11.082+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,082 [INFO] ✓ 预测完成: 216 条记录
[2025-11-05T09:41:11.083+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,082 [INFO] 类别分布: 0=126, 1=90
[2025-11-05T09:41:11.084+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,082 [INFO] 平均预测概率: 0.4125
[2025-11-05T09:41:11.093+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,093 [INFO] ✓ 预测结果已保存: /opt/airflow/model_bank/predictions/predictions_20251105_094111.csv
[2025-11-05T09:41:11.094+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,093 [INFO]
[2025-11-05T09:41:11.095+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:41:11.095+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,093 [INFO] ✅ 预测流程完成！
[2025-11-05T09:41:11.096+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,093 [INFO] ============================================================
[2025-11-05T09:41:11.097+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,093 [INFO]
[2025-11-05T09:41:11.098+0000] {subprocess.py:93} INFO - 预测结果示例（前5行）:
[2025-11-05T09:41:11.099+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,098 [INFO]
[2025-11-05T09:41:11.100+0000] {subprocess.py:93} INFO -    prediction  probability
[2025-11-05T09:41:11.100+0000] {subprocess.py:93} INFO - 0           1     0.853207
[2025-11-05T09:41:11.101+0000] {subprocess.py:93} INFO - 1           1     0.680816
[2025-11-05T09:41:11.102+0000] {subprocess.py:93} INFO - 2           0     0.054123
[2025-11-05T09:41:11.102+0000] {subprocess.py:93} INFO - 3           0     0.414024
[2025-11-05T09:41:11.103+0000] {subprocess.py:93} INFO - 4           1     0.757927
[2025-11-05T09:41:11.131+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,131 [INFO] ============================================================
[2025-11-05T09:41:11.132+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,131 [INFO] CatBoost Gold Price Prediction - 开始预测
[2025-11-05T09:41:11.133+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,131 [INFO] ============================================================
[2025-11-05T09:41:11.133+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,131 [INFO] [auto] ROOT         = /opt/airflow
[2025-11-05T09:41:11.134+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,131 [INFO] [auto] MODEL_PATH   = /opt/airflow/model_bank/catboost/catboost_gold_model.cbm
[2025-11-05T09:41:11.135+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,131 [INFO] [auto] DATA_PATH    = /opt/airflow/datamart/gold/gold_2024_09_01.csv
[2025-11-05T09:41:11.135+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,131 [INFO] [auto] OUTPUT_PATH  = /opt/airflow/model_bank/predictions/predictions_20251105_094111.csv
[2025-11-05T09:41:11.136+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,131 [INFO] 加载模型: /opt/airflow/model_bank/catboost/catboost_gold_model.cbm
[2025-11-05T09:41:11.143+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,143 [INFO] ✓ 模型加载成功
[2025-11-05T09:41:11.144+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,143 [INFO] 加载数据: /opt/airflow/datamart/gold/gold_2024_09_01.csv
[2025-11-05T09:41:11.151+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,151 [INFO] ✓ 数据加载成功: 216 条 × 35 列
[2025-11-05T09:41:11.152+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,151 [INFO] 预处理数据...
[2025-11-05T09:41:11.153+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,152 [INFO]   移除ID列: customerID
[2025-11-05T09:41:11.155+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,155 [INFO]   提取日期特征: snapdate
[2025-11-05T09:41:11.184+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,184 [INFO] ✓ 数据预处理完成
[2025-11-05T09:41:11.185+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,184 [INFO] 开始预测...
[2025-11-05T09:41:11.187+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,186 [INFO] 检测到类别列 28 个: ['Churn', 'Contract', 'PaperlessBilling', 'PaymentMethod', 'AutoRenewal', 'BillingCycle', 'DiscountApplied', 'LoyaltyProgramMember', 'PhoneService', 'MultipleLines', 'InternetService', 'OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies', 'SmartHomePackage', 'GamingBundle', 'InternationalCallingPlan', 'CloudStoragePlan', 'gender', 'Partner', 'Dependents', 'EducationLevel', 'EmploymentStatus', 'AnnualIncomeBracket', 'CustomerSatisfactionScore']
[2025-11-05T09:41:11.191+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,191 [INFO] ✓ 预测完成: 216 条记录
[2025-11-05T09:41:11.192+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,191 [INFO] 类别分布: 0=126, 1=90
[2025-11-05T09:41:11.194+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,191 [INFO] 平均预测概率: 0.4125
[2025-11-05T09:41:11.212+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,212 [INFO] ✓ 预测结果已保存: /opt/airflow/model_bank/predictions/predictions_20251105_094111.csv
[2025-11-05T09:41:11.213+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,212 [INFO]
[2025-11-05T09:41:11.214+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:41:11.215+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,212 [INFO] ✅ 预测流程完成！
[2025-11-05T09:41:11.215+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,212 [INFO] ============================================================
[2025-11-05T09:41:11.216+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,212 [INFO]
[2025-11-05T09:41:11.216+0000] {subprocess.py:93} INFO - 预测结果示例（前5行）:
[2025-11-05T09:41:11.217+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:11,217 [INFO]
[2025-11-05T09:41:11.218+0000] {subprocess.py:93} INFO -    prediction  probability
[2025-11-05T09:41:11.219+0000] {subprocess.py:93} INFO - 0           1     0.853207
[2025-11-05T09:41:11.219+0000] {subprocess.py:93} INFO - 1           1     0.680816
[2025-11-05T09:41:11.220+0000] {subprocess.py:93} INFO - 2           0     0.054123
[2025-11-05T09:41:11.221+0000] {subprocess.py:93} INFO - 3           0     0.414024
[2025-11-05T09:41:11.221+0000] {subprocess.py:93} INFO - 4           1     0.757927
[2025-11-05T09:41:11.330+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-11-05T09:41:11.376+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-11-05T09:41:11.377+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=e2e_pipeline, task_id=catboost_gold_predict, run_id=manual__2025-11-05T09:40:16.944660+00:00, execution_date=20251105T094016, start_date=20251105T094109, end_date=20251105T094111
[2025-11-05T09:41:11.456+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-11-05T09:41:11.498+0000] {taskinstance.py:3900} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-11-05T09:41:11.510+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
