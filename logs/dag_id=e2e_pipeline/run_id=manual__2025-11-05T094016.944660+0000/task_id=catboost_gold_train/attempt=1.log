[2025-11-05T09:40:59.957+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-11-05T09:40:59.982+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: e2e_pipeline.catboost_gold_train manual__2025-11-05T09:40:16.944660+00:00 [queued]>
[2025-11-05T09:41:00.003+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: e2e_pipeline.catboost_gold_train manual__2025-11-05T09:40:16.944660+00:00 [queued]>
[2025-11-05T09:41:00.004+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 1
[2025-11-05T09:41:00.049+0000] {taskinstance.py:2888} INFO - Executing <Task(BashOperator): catboost_gold_train> on 2025-11-05 09:40:16.944660+00:00
[2025-11-05T09:41:00.063+0000] {standard_task_runner.py:104} INFO - Running: ['airflow', 'tasks', 'run', 'e2e_pipeline', 'catboost_gold_train', 'manual__2025-11-05T09:40:16.944660+00:00', '--job-id', '49', '--raw', '--subdir', 'DAGS_FOLDER/e2e_pipeline_dag.py', '--cfg-path', '/tmp/tmpfa4k8q8k']
[2025-11-05T09:41:00.068+0000] {standard_task_runner.py:105} INFO - Job 49: Subtask catboost_gold_train
[2025-11-05T09:41:00.057+0000] {standard_task_runner.py:72} INFO - Started process 1028 to run task
[2025-11-05T09:41:00.197+0000] {task_command.py:467} INFO - Running <TaskInstance: e2e_pipeline.catboost_gold_train manual__2025-11-05T09:40:16.944660+00:00 [running]> on host 9d186853eb29
[2025-11-05T09:41:00.438+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='e2e_pipeline' AIRFLOW_CTX_TASK_ID='catboost_gold_train' AIRFLOW_CTX_EXECUTION_DATE='2025-11-05T09:40:16.944660+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-11-05T09:40:16.944660+00:00'
[2025-11-05T09:41:00.441+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-11-05T09:41:00.490+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-11-05T09:41:00.493+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'python /opt/airflow/scripts/catboost_gold_train.py']
[2025-11-05T09:41:00.516+0000] {subprocess.py:86} INFO - Output:
[2025-11-05T09:41:03.017+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,017 [INFO] ============================================================
[2025-11-05T09:41:03.019+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,017 [INFO] CatBoost Gold Price Prediction - 开始训练
[2025-11-05T09:41:03.020+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,017 [INFO] ============================================================
[2025-11-05T09:41:03.021+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,018 [INFO]
[2025-11-05T09:41:03.022+0000] {subprocess.py:93} INFO - 配置信息:
[2025-11-05T09:41:03.023+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,018 [INFO]   数据路径: /opt/airflow/datamart/gold
[2025-11-05T09:41:03.023+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,018 [INFO]   输出路径: /opt/airflow/model_bank/catboost
[2025-11-05T09:41:03.024+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,019 [INFO]   训练范围: (2023, 2) - (2024, 4)
[2025-11-05T09:41:03.025+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,019 [INFO]   OOT范围:  (2024, 5) - (2024, 9)
[2025-11-05T09:41:03.026+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,020 [INFO] ============================================================
[2025-11-05T09:41:03.027+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,020 [INFO] 开始读取黄金价格数据...
[2025-11-05T09:41:03.029+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,020 [INFO] ============================================================
[2025-11-05T09:41:03.030+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,020 [INFO]
[2025-11-05T09:41:03.030+0000] {subprocess.py:93} INFO - 训练集: 2023-02 至 2024-04 (共15个月)
[2025-11-05T09:41:03.032+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,020 [INFO] OOT集: 2024-05 至 2024-09 (共5个月)
[2025-11-05T09:41:03.033+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,021 [INFO]
[2025-11-05T09:41:03.034+0000] {subprocess.py:93} INFO - 读取训练集数据...
[2025-11-05T09:41:03.035+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,021 [INFO] ------------------------------------------------------------
[2025-11-05T09:41:03.036+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,031 [INFO]   ✓ gold_2023_02_01.csv: 233 条记录
[2025-11-05T09:41:03.041+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,041 [INFO]   ✓ gold_2023_03_01.csv: 224 条记录
[2025-11-05T09:41:03.049+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,048 [INFO]   ✓ gold_2023_04_01.csv: 228 条记录
[2025-11-05T09:41:03.058+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,058 [INFO]   ✓ gold_2023_05_01.csv: 216 条记录
[2025-11-05T09:41:03.065+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,065 [INFO]   ✓ gold_2023_06_01.csv: 214 条记录
[2025-11-05T09:41:03.074+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,074 [INFO]   ✓ gold_2023_07_01.csv: 219 条记录
[2025-11-05T09:41:03.081+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,081 [INFO]   ✓ gold_2023_08_01.csv: 239 条记录
[2025-11-05T09:41:03.089+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,089 [INFO]   ✓ gold_2023_09_01.csv: 225 条记录
[2025-11-05T09:41:03.096+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,096 [INFO]   ✓ gold_2023_10_01.csv: 215 条记录
[2025-11-05T09:41:03.102+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,102 [INFO]   ✓ gold_2023_11_01.csv: 213 条记录
[2025-11-05T09:41:03.108+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,108 [INFO]   ✓ gold_2023_12_01.csv: 219 条记录
[2025-11-05T09:41:03.114+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,114 [INFO]   ✓ gold_2024_01_01.csv: 232 条记录
[2025-11-05T09:41:03.121+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,121 [INFO]   ✓ gold_2024_02_01.csv: 217 条记录
[2025-11-05T09:41:03.126+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,126 [INFO]   ✓ gold_2024_03_01.csv: 240 条记录
[2025-11-05T09:41:03.132+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,132 [INFO]   ✓ gold_2024_04_01.csv: 230 条记录
[2025-11-05T09:41:03.134+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,133 [INFO]
[2025-11-05T09:41:03.135+0000] {subprocess.py:93} INFO - 训练集合并完成: 3,364 条记录
[2025-11-05T09:41:03.136+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,134 [INFO]
[2025-11-05T09:41:03.137+0000] {subprocess.py:93} INFO - 读取OOT集数据...
[2025-11-05T09:41:03.138+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,135 [INFO] ------------------------------------------------------------
[2025-11-05T09:41:03.141+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,141 [INFO]   ✓ gold_2024_05_01.csv: 210 条记录
[2025-11-05T09:41:03.146+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,146 [INFO]   ✓ gold_2024_06_01.csv: 221 条记录
[2025-11-05T09:41:03.153+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,153 [INFO]   ✓ gold_2024_07_01.csv: 231 条记录
[2025-11-05T09:41:03.160+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,159 [INFO]   ✓ gold_2024_08_01.csv: 221 条记录
[2025-11-05T09:41:03.166+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,165 [INFO]   ✓ gold_2024_09_01.csv: 216 条记录
[2025-11-05T09:41:03.167+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,166 [INFO]
[2025-11-05T09:41:03.168+0000] {subprocess.py:93} INFO - OOT集合并完成: 1,099 条记录
[2025-11-05T09:41:03.169+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,167 [INFO]
[2025-11-05T09:41:03.170+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:41:03.171+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,167 [INFO] 数据加载完成!
[2025-11-05T09:41:03.171+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,167 [INFO] ============================================================
[2025-11-05T09:41:03.172+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,167 [INFO]
[2025-11-05T09:41:03.173+0000] {subprocess.py:93} INFO - 训练集: 3,364 条 × 38 列
[2025-11-05T09:41:03.173+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,167 [INFO] OOT集:  1,099 条 × 38 列
[2025-11-05T09:41:03.174+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,169 [INFO]
[2025-11-05T09:41:03.174+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:41:03.175+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,169 [INFO] 开始数据预处理...
[2025-11-05T09:41:03.176+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,169 [INFO] ============================================================
[2025-11-05T09:41:03.177+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,173 [INFO] ✓ 找到目标变量: Churn
[2025-11-05T09:41:03.177+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,176 [INFO] ✓ 目标变量转换完成 (Yes/No -> 1/0)
[2025-11-05T09:41:03.178+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,176 [INFO]
[2025-11-05T09:41:03.179+0000] {subprocess.py:93} INFO - 目标变量分布:
[2025-11-05T09:41:03.180+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,176 [INFO] Churn
[2025-11-05T09:41:03.181+0000] {subprocess.py:93} INFO - 0    3262
[2025-11-05T09:41:03.182+0000] {subprocess.py:93} INFO - 1    1201
[2025-11-05T09:41:03.183+0000] {subprocess.py:93} INFO - Name: count, dtype: int64
[2025-11-05T09:41:03.184+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,177 [INFO] 正样本比例: 26.91%
[2025-11-05T09:41:03.184+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,178 [INFO] ✓ 已移除ID列: customerID
[2025-11-05T09:41:03.185+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,184 [INFO] ✓ 日期特征提取完成: snapdate
[2025-11-05T09:41:03.186+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,186 [INFO] ✓ 数值型缺失值填充完成
[2025-11-05T09:41:03.191+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,190 [INFO] ✓ 类别型缺失值填充完成
[2025-11-05T09:41:03.192+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,191 [INFO]
[2025-11-05T09:41:03.193+0000] {subprocess.py:93} INFO - ------------------------------------------------------------
[2025-11-05T09:41:03.194+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,191 [INFO] 识别和处理类别特征...
[2025-11-05T09:41:03.195+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,192 [INFO] ------------------------------------------------------------
[2025-11-05T09:41:03.199+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,198 [INFO] ✓ 识别到 27 个类别特征
[2025-11-05T09:41:03.200+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,199 [INFO] 类别特征: ['Contract', 'PaperlessBilling', 'PaymentMethod', 'AutoRenewal', 'BillingCycle', 'DiscountApplied', 'LoyaltyProgramMember', 'PhoneService', 'MultipleLines', 'InternetService']...
[2025-11-05T09:41:03.201+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,199 [INFO]
[2025-11-05T09:41:03.202+0000] {subprocess.py:93} INFO - ✓ 数据预处理完成，当前数据维度: (4463, 39)
[2025-11-05T09:41:03.203+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,200 [INFO]
[2025-11-05T09:41:03.204+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:41:03.205+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,200 [INFO] 准备训练数据...
[2025-11-05T09:41:03.207+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,201 [INFO] ============================================================
[2025-11-05T09:41:03.209+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,209 [INFO]
[2025-11-05T09:41:03.210+0000] {subprocess.py:93} INFO - 时间范围分布:
[2025-11-05T09:41:03.211+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,209 [INFO]   训练+验证集: 3364 条
[2025-11-05T09:41:03.213+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,210 [INFO]   OOT集: 2018 条
[2025-11-05T09:41:03.218+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,217 [INFO]
[2025-11-05T09:41:03.219+0000] {subprocess.py:93} INFO - 最终划分:
[2025-11-05T09:41:03.220+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,218 [INFO]   训练集: (2691, 35)
[2025-11-05T09:41:03.221+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,218 [INFO]   验证集: (673, 35)
[2025-11-05T09:41:03.222+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,219 [INFO]   OOT集: (2018, 35)
[2025-11-05T09:41:03.223+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,219 [INFO]
[2025-11-05T09:41:03.225+0000] {subprocess.py:93} INFO - 类别特征索引: 27 个
[2025-11-05T09:41:03.226+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,220 [INFO]
[2025-11-05T09:41:03.227+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:41:03.229+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,221 [INFO] 训练CatBoost模型...
[2025-11-05T09:41:03.230+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,221 [INFO] ============================================================
[2025-11-05T09:41:03.231+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,221 [INFO] 模型配置:
[2025-11-05T09:41:03.232+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,222 [INFO]   - iterations: 1000
[2025-11-05T09:41:03.233+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,222 [INFO]   - learning_rate: 0.03
[2025-11-05T09:41:03.233+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,222 [INFO]   - depth: 6
[2025-11-05T09:41:03.234+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,223 [INFO]   - cat_features: 27 个
[2025-11-05T09:41:03.235+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,223 [INFO]
[2025-11-05T09:41:03.236+0000] {subprocess.py:93} INFO - 开始训练...
[2025-11-05T09:41:03.237+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:03,223 [INFO] ------------------------------------------------------------
[2025-11-05T09:41:06.161+0000] {subprocess.py:93} INFO - 0:	test: 0.7885158	best: 0.7885158 (0)	total: 68.9ms	remaining: 1m 8s
[2025-11-05T09:41:06.162+0000] {subprocess.py:93} INFO - 100:	test: 0.8228750	best: 0.8232306 (96)	total: 885ms	remaining: 7.88s
[2025-11-05T09:41:06.163+0000] {subprocess.py:93} INFO - 200:	test: 0.8284876	best: 0.8288099 (197)	total: 1.67s	remaining: 6.65s
[2025-11-05T09:41:06.164+0000] {subprocess.py:93} INFO - 300:	test: 0.8301214	best: 0.8305215 (286)	total: 2.44s	remaining: 5.68s
[2025-11-05T09:41:06.165+0000] {subprocess.py:93} INFO - Stopped by overfitting detector  (50 iterations wait)
[2025-11-05T09:41:06.167+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:41:06.168+0000] {subprocess.py:93} INFO - bestTest = 0.8305214724
[2025-11-05T09:41:06.168+0000] {subprocess.py:93} INFO - bestIteration = 286
[2025-11-05T09:41:06.169+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:41:06.170+0000] {subprocess.py:93} INFO - Shrink model to first 287 iterations.
[2025-11-05T09:41:06.171+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,160 [INFO]
[2025-11-05T09:41:06.173+0000] {subprocess.py:93} INFO - ✓ 模型训练完成！
[2025-11-05T09:41:06.173+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,161 [INFO] ✓ 最佳迭代次数: 286
[2025-11-05T09:41:06.174+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,161 [INFO] ✓ 最佳验证AUC: 0.8305
[2025-11-05T09:41:06.175+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,161 [INFO]
[2025-11-05T09:41:06.176+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:41:06.177+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,161 [INFO] 模型评估...
[2025-11-05T09:41:06.177+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,162 [INFO] ============================================================
[2025-11-05T09:41:06.178+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,174 [INFO]
[2025-11-05T09:41:06.179+0000] {subprocess.py:93} INFO - 验证集评估:
[2025-11-05T09:41:06.180+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,175 [INFO] ============================================================
[2025-11-05T09:41:06.185+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,184 [INFO]
[2025-11-05T09:41:06.186+0000] {subprocess.py:93} INFO -               precision    recall  f1-score   support
[2025-11-05T09:41:06.187+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:41:06.187+0000] {subprocess.py:93} INFO -            0       0.91      0.70      0.79       489
[2025-11-05T09:41:06.188+0000] {subprocess.py:93} INFO -            1       0.50      0.81      0.62       184
[2025-11-05T09:41:06.189+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:41:06.190+0000] {subprocess.py:93} INFO -     accuracy                           0.73       673
[2025-11-05T09:41:06.191+0000] {subprocess.py:93} INFO -    macro avg       0.71      0.75      0.71       673
[2025-11-05T09:41:06.192+0000] {subprocess.py:93} INFO - weighted avg       0.80      0.73      0.74       673
[2025-11-05T09:41:06.193+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:41:06.194+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,188 [INFO]
[2025-11-05T09:41:06.195+0000] {subprocess.py:93} INFO - 核心指标:
[2025-11-05T09:41:06.195+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,188 [INFO]   Accuracy: 0.7296
[2025-11-05T09:41:06.197+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,188 [INFO]   AUC-ROC:  0.8305
[2025-11-05T09:41:06.197+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,189 [INFO]
[2025-11-05T09:41:06.200+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:41:06.201+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,189 [INFO] OOT集评估:
[2025-11-05T09:41:06.202+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,189 [INFO] ============================================================
[2025-11-05T09:41:06.218+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,218 [INFO]
[2025-11-05T09:41:06.220+0000] {subprocess.py:93} INFO -               precision    recall  f1-score   support
[2025-11-05T09:41:06.221+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:41:06.222+0000] {subprocess.py:93} INFO -            0       0.92      0.73      0.81      1488
[2025-11-05T09:41:06.223+0000] {subprocess.py:93} INFO -            1       0.51      0.82      0.63       530
[2025-11-05T09:41:06.223+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:41:06.224+0000] {subprocess.py:93} INFO -     accuracy                           0.75      2018
[2025-11-05T09:41:06.225+0000] {subprocess.py:93} INFO -    macro avg       0.72      0.77      0.72      2018
[2025-11-05T09:41:06.226+0000] {subprocess.py:93} INFO - weighted avg       0.81      0.75      0.76      2018
[2025-11-05T09:41:06.227+0000] {subprocess.py:93} INFO - 
[2025-11-05T09:41:06.228+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,221 [INFO]
[2025-11-05T09:41:06.229+0000] {subprocess.py:93} INFO - 核心指标:
[2025-11-05T09:41:06.230+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,221 [INFO]   Accuracy: 0.7498
[2025-11-05T09:41:06.231+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,221 [INFO]   AUC-ROC:  0.8569
[2025-11-05T09:41:06.232+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,222 [INFO]
[2025-11-05T09:41:06.233+0000] {subprocess.py:93} INFO - 模型稳定性 (PSI): 0.0146
[2025-11-05T09:41:06.234+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,222 [INFO]   ✓ PSI < 0.1: 模型稳定性良好
[2025-11-05T09:41:06.235+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,222 [INFO]
[2025-11-05T09:41:06.236+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:41:06.237+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,223 [INFO] 保存模型和结果...
[2025-11-05T09:41:06.237+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,223 [INFO] ============================================================
[2025-11-05T09:41:06.245+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,245 [INFO] ✓ 模型已保存: /opt/airflow/model_bank/catboost/catboost_gold_model.cbm
[2025-11-05T09:41:06.254+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,254 [INFO] ✓ 特征重要性已保存: /opt/airflow/model_bank/catboost/feature_importance.csv
[2025-11-05T09:41:06.261+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,260 [INFO] ✓ 预测结果已保存: /opt/airflow/model_bank/catboost/predictions.csv
[2025-11-05T09:41:06.265+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,264 [INFO] ✓ 评估指标已保存: /opt/airflow/model_bank/catboost/model_metrics.csv
[2025-11-05T09:41:06.266+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,265 [INFO]
[2025-11-05T09:41:06.267+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:41:06.268+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,265 [INFO] ✅ 所有结果已保存!
[2025-11-05T09:41:06.269+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,265 [INFO] ============================================================
[2025-11-05T09:41:06.270+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,266 [INFO]
[2025-11-05T09:41:06.271+0000] {subprocess.py:93} INFO - ============================================================
[2025-11-05T09:41:06.272+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,266 [INFO] ✅ 训练流程全部完成！
[2025-11-05T09:41:06.273+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,266 [INFO] ============================================================
[2025-11-05T09:41:06.274+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,267 [INFO]
[2025-11-05T09:41:06.275+0000] {subprocess.py:93} INFO - 生成的文件位于: /opt/airflow/model_bank/catboost
[2025-11-05T09:41:06.275+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,267 [INFO]
[2025-11-05T09:41:06.277+0000] {subprocess.py:93} INFO - 模型加载示例:
[2025-11-05T09:41:06.278+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,267 [INFO]   from catboost import CatBoostClassifier
[2025-11-05T09:41:06.279+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,267 [INFO]   model = CatBoostClassifier()
[2025-11-05T09:41:06.280+0000] {subprocess.py:93} INFO - 2025-11-05 09:41:06,268 [INFO]   model.load_model('/opt/airflow/model_bank/catboost/catboost_gold_model.cbm')
[2025-11-05T09:41:06.418+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-11-05T09:41:06.467+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-11-05T09:41:06.468+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=e2e_pipeline, task_id=catboost_gold_train, run_id=manual__2025-11-05T09:40:16.944660+00:00, execution_date=20251105T094016, start_date=20251105T094059, end_date=20251105T094106
[2025-11-05T09:41:06.528+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-11-05T09:41:06.565+0000] {taskinstance.py:3900} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-11-05T09:41:06.577+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
